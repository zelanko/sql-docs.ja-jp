---
title: カーソルとは | Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 7d903b2a5f971d0b6c7114a9e5229bff6133d743
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2020
ms.locfileid: "67923455"
---
# <a name="what-is-a-cursor"></a>カーソルとは
リレーショナル データベースで操作を実行する場合、行の完全なセットが操作の対象になります。 SELECT ステートメントでは、WHERE 句で指定した条件を満たすすべての行のセットが返されます。 このステートメントが返す行の完全なセットを結果セットと呼びます。 アプリケーション (特に対話型でオンラインになっているアプリケーション) は、結果セット全体を1つの単位として効率的に処理することはできません。 そのため、このようなアプリケーションでは、一度に 1 行または少数の行のブロックを使用するためのメカニズムが必要になります。 カーソルはそのメカニズムを提供する結果セットの拡張機能です。  
  
 カーソルは、カーソルライブラリによって実装されます。 カーソルライブラリは、多くの場合、データベースシステムまたはデータアクセス API の一部として実装されるソフトウェアで、データソースから返されるデータの属性 (結果セット) を管理するために使用されます。 これらの属性には、同時実行管理、結果セット内の位置、返された行数、および結果セット (スクロール機能) を使用して前方または後方 (またはその両方) を移動できるかどうかが含まれます。  
  
 カーソルは、結果セット内の位置を追跡します。これにより、結果セットに対して複数の操作を行ごとに実行できます。また、元のテーブルに戻ることもできます。 言い換えると、カーソルは概念的にはデータベース内のテーブルに基づいて結果セットを返します。 このカーソルは、コンピューター画面上のカーソルが現在の位置を示しているのと同じように、結果セット内の現在の位置を示すので、という名前になります。  
  
 ADO での使用方法の詳細については、「」に進む前に、カーソルの概念を理解しておくことが重要です。  
  
 カーソルを使用すると、次のことができます。  
  
-   結果セット内の特定の行の位置を指定します。  
  
-   現在の結果セットの位置に基づいて、1行または行のブロックを取得します。  
  
-   結果セットの現在位置にある行のデータを変更します。  
  
-   他のユーザーが行ったデータ変更に対するさまざまなレベルの感度を定義します。  
  
 たとえば、利用可能な製品の一覧を見込み購入者に表示するアプリケーションについて考えてみます。 購入者は一覧をスクロールして製品の詳細とコストを確認し、最後に購入する製品を選択します。 その他のスクロールと選択は、一覧の残りの部分で行われます。 購入者にとっては、製品は一度に1つずつ表示されますが、アプリケーションは、スクロール可能なカーソルを使用して結果セットを参照します。  
  
 カーソルは、さまざまな方法で使用できます。  
  
-   行をまったく使用しません。  
  
-   1つのテーブル内の行の一部またはすべてを含む。  
  
-   論理的に結合されたテーブルの行の一部またはすべてを使用します。  
  
-   カーソルまたはフィールドレベルで読み取り専用または更新可能として表示されます。  
  
-   順方向専用または完全なスクロール可能。  
  
-   サーバーにカーソルキーセットを配置します。  
  
-   他のアプリケーション (メンバーシップ、並べ替え、挿入、更新、削除など) によって発生する、基になるテーブルの変更に影響します。  
  
-   サーバーまたはクライアントのいずれかに存在します。  
  
 読み取り専用カーソルは、ユーザーが結果セットを参照するのに役立ちます。また、読み取り/書き込みカーソルは、個々の行の更新を実装できます。 複合カーソルは、ベーステーブルの行を指すキーセットを使用して定義できます。 一部のカーソルは前方に読み取り専用である場合もあれば、他のアプリケーションがデータベースに対して行った変更に基づいて、結果セットの動的な更新を行うこともできます。  
  
 すべてのアプリケーションで、カーソルを使用してデータにアクセスしたり、データを更新したりする必要はありません。 一部のクエリでは、カーソルを使用した行の直接更新は不要です。 カーソルはデータを取得するために選択した最後の手法の1つである必要があります。その場合、可能な限り最も低い影響カーソルを選択する必要があります。 ストアドプロシージャを使用して結果セットを作成する場合、cursor edit メソッドまたは update メソッドを使用して結果セットを更新することはできません。  
  
## <a name="concurrency"></a>コンカレンシー  
 一部のマルチユーザーアプリケーションでは、エンドユーザーに提供されるデータを可能な限り最新のものにすることが非常に重要です。 このようなシステムの典型的な例として、航空券予約システムがあります。このシステムでは、多くのユーザーが特定のフライトで同じ座席 (つまり、1つのレコード) を競合している可能性があります。 このような場合、アプリケーションの設計では、1つのレコードに対して同時実行操作を処理する必要があります。  
  
 他のアプリケーションでは、同時実行は重要ではありません。 このような場合、データを常に最新の状態に保つために必要な費用を正当化することはできません。  
  
## <a name="position"></a>[位置]  
 カーソルは、結果セット内の現在位置を追跡することもできます。 カーソル位置は、現在のレコードへのポインターと考えることができます。これは、配列インデックスが配列内の特定の位置にある値を指す方法と似ています。  
  
## <a name="scrollability"></a>スクロール可能  
 アプリケーションによって使用されるカーソルの種類は、結果セット内の行を前方または後方に移動する機能にも影響します。これは、スクロール機能と呼ばれることもあります。 結果セットを前後に移動する機能によって、カーソルの複雑さが増します。したがって、を実装*するとコスト*が高くなります。 このため、必要な場合にのみ、この機能を使用してカーソルを要求する必要があります。
