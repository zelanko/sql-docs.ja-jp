---
description: Field オブジェクト
title: Field オブジェクト |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Field object [ADO]
ms.assetid: 7d1c4ad5-4be3-42ab-b516-e7133ca300bc
author: rothja
ms.author: jroth
ms.openlocfilehash: 16f1b85006366702b0f95d5a41a74abf91ac7997
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88452764"
---
# <a name="the-field-object"></a>Field オブジェクト
各 **Field** オブジェクトは、通常、データベーステーブルの列に対応します。 ただし、 **フィールド** は、チャプターと呼ばれる別の **レコードセット**へのポインターを表すこともできます。 チャプター列などの例外については、このガイドの後半で説明します。  
  
 現在のレコードのデータを設定または取得するには、 **Field**オブジェクトの**Value**プロパティを使用します。 プロバイダーが公開する機能によっては、 **フィールド** オブジェクトの一部のコレクション、メソッド、またはプロパティが使用できないことがあります。  
  
 **Field**オブジェクトのコレクション、メソッド、およびプロパティを使用して、次の操作を実行できます。  
  
-   **Name**プロパティを使用して、フィールドの名前を返します。  
  
-   " **値** " プロパティを使用して、フィールド内のデータを表示または変更します。 **Value** は、 **Field** オブジェクトの既定のプロパティです。  
  
-   **型**、**有効桁数**、および**numericscale**プロパティを使用して、フィールドの基本的な特性を返します。  
  
-   "定義済みの **サイズ** " プロパティを使用して、フィールドの宣言されたサイズを返します。  
  
-   **ActualSize**プロパティを使用して、指定されたフィールド内のデータの実際のサイズを返します。  
  
-   **Attributes**プロパティと**Properties**コレクションを使用して、特定のフィールドでサポートされる機能の種類を決定します。  
  
-   **Appendchunk**メソッドと**GetChunk**メソッドを使用して、長いバイナリまたは長い文字データを含むフィールドの値を操作します。  
  
 プロバイダーがバッチ更新をサポートしている場合は、 **Originalvalue** プロパティと **UnderlyingValue** プロパティを使用して、バッチ更新中のフィールド値の不一致を解決します。  
  
## <a name="describing-a-field"></a>フィールドの説明  
 次のトピックでは、**フィールドオブジェクト自体につい**て説明する情報 (フィールドに関するメタデータ) を表す[field](../../../ado/reference/ado-api/field-object.md)オブジェクトのプロパティについて説明します。 この情報を使用して、 **レコードセット**のスキーマに関する情報を確認できます。 これらのプロパティには、 **Type**、指定された **サイズ** と **ActualSize**、 **Name**、および **numericscale** と **Precision**が含まれます。  
  
### <a name="discovering-the-data-type"></a>データ型の検出  
 **Type**プロパティは、フィールドのデータ型を示します。 ADO によってサポートされるデータ型の列挙定数については、 *Ado プログラマーリファレンス*の[DataTypeEnum](../../../ado/reference/ado-api/datatypeenum.md)を参照してください。  
  
 **Adnumeric**などの浮動小数点数値型の詳細については、こちらを参照してください。 **Numericscale**プロパティは、**フィールド**の値を表すために使用される小数点以下の桁数を示します。 **Precision**プロパティは、**フィールド**の値を表すために使用される最大桁数を指定します。  
  
### <a name="determining-field-size"></a>フィールドサイズの決定  
 フィールドオブジェクトのデータ容量を確認するには、 **"** 定義済み**サイズ**" プロパティを使用します。  
  
 **ActualSize**プロパティを使用して、**フィールド**オブジェクトの値の実際の長さを返します。 すべてのフィールドに対して、 **ActualSize** プロパティは読み取り専用です。 ADO が **フィールド** オブジェクトの値の長さを判断できない場合、 **ActualSize** プロパティは **adunknown**を返します。  
  
 **ActualSize**プロパティにはさまざまな**目的があり**ます。 たとえば、 **adVarChar**という宣言された型を持つ**Field**オブジェクトと、1つの文字を含む定義済みの**size**プロパティ値50を考えてみます。 返される **ActualSize** プロパティ値は、1文字の長さ (バイト単位) です。  
  
### <a name="determining-field-contents"></a>フィールドの内容の決定  
 データソースからの列の識別子は、**フィールド**の**Name**プロパティによって表されます。 **Field**オブジェクトの Value プロパティは、フィールドの実際のデータコンテンツを返します。**値**の設定もできます。 これは、既定のプロパティです。  
  
 フィールド内のデータを変更するには、[ **値** ] プロパティを正しい型の新しい値に設定します。 カーソルの種類では、フィールドの内容を変更するための更新プログラムがサポートされている必要があります。 ここでは、データベースの検証はバッチモードでは実行されないため、このような場合には、 **UpdateBatch** を呼び出すとエラーをチェックする必要があります。 一部のプロバイダーでは、ADO **Field** オブジェクトの **UnderlyingValue** プロパティと **originalvalue** プロパティもサポートされており、バッチ更新を実行しようとしたときの競合の解決に役立ちます。 このような競合を解決する方法の詳細については、「 [データの編集](../../../ado/guide/data/editing-data.md)」を参照してください。  
  
> [!NOTE]
>  レコードセットに新しい**フィールド**を追加するときに、**レコードセットフィールド**の**値を設定**することはできません。 代わりに、閉じた**レコードセット**に新しい**フィールド**を追加できます。 次に、 **レコードセット** を開く必要があります。その後、これらの **フィールド**に値を割り当てることができます。  
  
### <a name="getting-more-field-information"></a>フィールド情報の取得  
 ADO オブジェクトには、組み込みと動的の2種類のプロパティがあります。 この時点で、 **フィールド** オブジェクトの組み込みプロパティだけが説明されています。  
  
 組み込みプロパティは ADO で実装されるプロパティで、構文を使用して、新しいオブジェクトですぐに使用でき `MyObject.Property` ます。 これらは、オブジェクトの**プロパティ**コレクション内の**プロパティ**オブジェクトとしては表示されません。  
  
 動的プロパティは、基になるデータプロバイダーによって定義され、適切な ADO オブジェクトの **properties** コレクションに表示されます。 たとえば、プロバイダー固有のプロパティは、 **レコードセット** オブジェクトがトランザクションをサポートするか更新するかを示します。 これらの追加のプロパティは、その**レコードセット**オブジェクトの**プロパティ**コレクション内の**プロパティ**オブジェクトとして表示されます。 動的プロパティを参照できるのは、構文またはを使用して、コレクションを通じてのみ `MyObject.Properties(0)` `MyObject.Properties("Name")` です。  
  
 どちらの種類のプロパティも削除できません。  
  
 動的 **プロパティ** オブジェクトには、次の4つの組み込みプロパティがあります。  
  
-   **Name**プロパティは、プロパティを識別する文字列です。  
  
-   **Type**プロパティは、プロパティのデータ型を指定する整数です。  
  
-   **Value**プロパティは、プロパティ設定を含むバリアントです。 **Value** は、 **プロパティ** オブジェクトの既定のプロパティです。  
  
-   **Attributes**プロパティは、プロバイダー固有のプロパティの特性を示す**Long 型**の値です。  
  
 **Field**オブジェクトの**Properties**コレクションには、フィールドに関する追加のメタデータが含まれています。 このコレクションの内容は、プロバイダーによって異なります。 次のコード例では、このセクションの冒頭で紹介したサンプル**レコードセット**の**Properties**コレクションを調べます。 まず、コレクションの内容を確認します。 このコードでは、 [SQL Server の OLE DB プロバイダー](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md)を使用するため、 **Properties** コレクションにはそのプロバイダーに関連する情報が含まれています。  
  
```  
'BeginFieldProps  
    Dim objProp As ADODB.Property  
  
    For intLoop = 0 To (objFields.Count - 1)  
        Debug.Print objFields.Item(intLoop).Name  
  
        For Each objProp In objFields(intLoop).Properties  
            Debug.Print vbTab & objProp.Name & " = " & objProp.Value  
        Next objProp  
    Next intLoop  
'EndFieldProps  
```  
  
### <a name="dealing-with-binary-data"></a>バイナリデータの処理  
 **Field**オブジェクトに対して[appendchunk](../../../ado/reference/ado-api/appendchunk-method-ado.md)メソッドを使用して、長いバイナリデータまたは文字データを格納します。 システムメモリが制限されている場合は、 **Appendchunk** メソッドを使用して、長い値を全体ではなく部分的に操作することができます。  
  
 **Field**オブジェクトの**Attributes**プロパティの**Adfldlong**ビットが**True**に設定されている場合は、そのフィールドに**appendchunk**メソッドを使用できます。  
  
 **Field**オブジェクトの最初の**appendchunk**呼び出しでは、データがフィールドに書き込まれ、既存のデータが上書きされます。 後続の **Appendchunk** 呼び出しでは、を既存のデータに追加します。 1つのフィールドにデータを追加した後、現在のレコードの別のフィールドの値を設定または読み取る場合、ADO は最初のフィールドにデータを追加したことを前提としています。 最初のフィールドで **appendchunk** メソッドを再度呼び出すと、ADO は呼び出しを新しい **appendchunk** 操作として解釈し、既存のデータを上書きします。 最初の**レコードセット**オブジェクトの複製ではない他の**レコードセット**オブジェクトのフィールドにアクセスしても、 **appendchunk**操作が中断されることはありません。  
  
 **Field**オブジェクトの**GetChunk**メソッドを使用して、その長いバイナリデータまたは文字データの一部またはすべてを取得します。 システムメモリが制限されている場合は、 **GetChunk** メソッドを使用して、全体ではなく、長い値を部分的に操作することができます。  
  
 **GetChunk**呼び出しによって返されるデータは、*変数*に代入されます。 *Size*が残りのデータよりも大きい場合、 **GetChunk**メソッドは、空のスペースを含む*変数*を埋めずに残りのデータだけを返します。 フィールドが空の場合、 **GetChunk** メソッドは null 値を返します。  
  
 後続の各 **getchunk** 呼び出しは、前の **getchunk** 呼び出しが終了した場所からデータを取得します。 ただし、あるフィールドからデータを取得し、現在のレコードの別のフィールドの値を設定または読み取る場合、ADO では最初のフィールドからのデータの取得が完了したと見なされます。 最初のフィールドに対して **getchunk** メソッドを再度呼び出すと、ADO はその呼び出しを新しい **GetChunk** 操作として解釈し、データの先頭からの読み取りを開始します。 最初の**レコードセット**オブジェクトの複製ではない他の**レコードセット**オブジェクトのフィールドにアクセスしても、 **GetChunk**操作が中断されることはありません。  
  
 **Field**オブジェクトの**Attributes**プロパティの**Adfldlong**ビットが**True**に設定されている場合は、そのフィールドに対して**GetChunk**メソッドを使用できます。  
  
 **Field**オブジェクトで**GetChunk**または**appendchunk**メソッドを使用しているときに現在のレコードが存在しない場合、エラー 3021 (現在のレコードがありません) が発生します。  
  
 これらのメソッドを使用してバイナリデータを操作する例については、 *ADO プログラマーリファレンス*の[appendchunk メソッド](../../../ado/reference/ado-api/appendchunk-method-ado.md)と[GetChunk メソッド](../../../ado/reference/ado-api/getchunk-method-ado.md)の例を参照してください。
