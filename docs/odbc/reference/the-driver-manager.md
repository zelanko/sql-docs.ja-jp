---
title: ドライバーマネージャー |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 686a2b9673fb392f969a42f4cc86dd95a95668a6
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2020
ms.locfileid: "81286796"
---
# <a name="the-driver-manager"></a>ドライバー マネージャー
*ドライバーマネージャー*は、アプリケーションとドライバー間の通信を管理するライブラリです。 たとえば、Microsoft® Windows®プラットフォームでは、ドライバーマネージャーは、Microsoft によって作成されたダイナミックリンクライブラリ (DLL) であり、再配布可能な MDAC 2.8 SP1 SDK のユーザーが再配布できます。  
  
 ドライバーマネージャーは、主としてアプリケーションの作成者にとって便利であり、すべてのアプリケーションに共通する多くの問題を解決します。 これには、データソース名、ドライバーの読み込みとアンロード、およびドライバーでの関数の呼び出しに基づいて、どのドライバーを読み込むかを決定することが含まれます。  
  
 後者が問題である理由を確認するには、アプリケーションがドライバー内の関数を直接呼び出した場合に何が起こるかを考えてみてください。 アプリケーションが特定のドライバーに直接リンクされていない場合は、そのドライバー内の関数へのポインターのテーブルを作成し、それらの関数をポインターで呼び出す必要があります。 一度に複数のドライバーに同じコードを使用すると、もう1つの複雑さが増します。 アプリケーションでは、まず、正しいドライバーの正しい関数を指すように関数ポインターを設定してから、そのポインターを使用して関数を呼び出します。  
  
 ドライバーマネージャーは、各関数を呼び出すための単一の場所を提供することで、この問題を解決します。 アプリケーションがドライバーマネージャーにリンクされ、ドライバーマネージャーで ODBC 関数が呼び出されます。ドライバーは呼び出されません。 アプリケーションは、*接続ハンドル*を使用してターゲットドライバーとデータソースを識別します。 ドライバーが読み込まれると、ドライバーマネージャーは、そのドライバー内の関数へのポインターのテーブルを作成します。 アプリケーションによって渡された接続ハンドルを使用して、ターゲットドライバーの関数のアドレスを検索し、アドレスによって関数を呼び出します。  
  
 ほとんどの場合、ドライバーマネージャーは、アプリケーションから適切なドライバーに関数呼び出しを渡します。 ただし、一部の関数 (**Sqldatasources ソース**、 **Sqldatasources**、 **sqlgetfunctions**) も実装し、基本的なエラーチェックを実行します。 たとえば、ドライバーマネージャーは、ハンドルが null ポインターではないこと、その関数が正しい順序で呼び出されていること、および特定の関数の引数が有効であることを確認します。 ドライバーマネージャーによって確認されたエラーの詳細については、各関数のリファレンスセクションと[「付録 B: ODBC 状態遷移テーブル](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)」を参照してください。  
  
 ドライバーマネージャーの最終的な主要な役割は、ドライバーの読み込みとアンロードです。 アプリケーションは、ドライバーマネージャーだけを読み込んでアンロードします。 特定のドライバーを使用する場合は、ドライバーマネージャーで接続関数 (**SQLConnect**、 **SQLDriverConnect**、または**SQLBrowseConnect**) を呼び出し、"Accounting" や "SQL Server" などの特定のデータソースまたはドライバーの名前を指定します。 ドライバーマネージャーは、この名前を使用して、データソース情報でドライバーのファイル名 (Sqlsrvr .dll など) を検索します。 次に、ドライバーを読み込んで (まだ読み込まれていない場合)、各関数のアドレスをドライバーに格納して、ドライバー内の接続関数を呼び出します。ドライバーは、それ自体を初期化し、データソースに接続します。  
  
 ドライバーを使用してアプリケーションを実行すると、ドライバーマネージャーで**Sqldisconnect**が呼び出されます。 ドライバーマネージャーは、この関数をドライバーで呼び出し、データソースから切断します。 ただし、ドライバーマネージャーは、アプリケーションが再接続した場合に備えて、ドライバーをメモリ内に保持します。 ドライバーによって使用される接続をアプリケーションが解放した場合、または別のドライバーの接続を使用していて、他の接続がドライバーを使用していない場合にのみ、ドライバーがアンロードされます。 ドライバーマネージャーのドライバーの読み込みとアンロードの役割の詳細については、「[接続プロセスにおけるドライバーマネージャーの役割](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md)」を参照してください。
