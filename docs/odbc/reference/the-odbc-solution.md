---
title: ODBC ソリューション |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC [ODBC], database access
- SQL [ODBC], database access
- database access [ODBC]
- standardizing database access [ODBC], using ODBC
ms.assetid: 34b80790-e010-4b90-8eaa-03189f5d8986
author: MightyPen
ms.author: genemi
ms.openlocfilehash: e6992e084c210cea1b95157744addfd40180fccb
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2020
ms.locfileid: "68039344"
---
# <a name="the-odbc-solution"></a>ODBC ソリューション
次に、ODBC がデータベースへのアクセスを標準化する方法を説明します。 アーキテクチャには、次の2つの要件があります。  
  
-   アプリケーションは、再コンパイルまたは再リンクを行わずに、同じソースコードを使用して複数の Dbms にアクセスできる必要があります。  
  
-   アプリケーションは、同時に複数の Dbms にアクセスできる必要があります。  
  
 Marketplace の現実によって、もう1つ質問があります。  
  
-   ODBC で公開する DBMS の機能 すべての dbms に共通する機能、または任意の DBMS で利用できる機能のみ。  
  
 ODBC では、次の方法でこれらの問題を解決します。  
  
-   **ODBC は、呼び出しレベルのインターフェイスです。** アプリケーションが同じソースコードを使用して複数の Dbms にアクセスする場合の問題を解決するために、ODBC では標準 CLI が定義されています。 これには、Open Group と ISO/IEC から CLI 仕様のすべての関数が含まれており、アプリケーションで一般的に必要とされる追加の機能を提供します。  
  
     ODBC をサポートする DBMS ごとに、別のライブラリ (ドライバー) が必要です。 ドライバーは、ODBC API の関数を実装します。 別のドライバーを使用するには、アプリケーションを再コンパイルまたは再リンクする必要はありません。 代わりに、アプリケーションは単に新しいドライバーを読み込んで、そのドライバー内の関数を呼び出します。 複数の Dbms に同時にアクセスするために、アプリケーションは複数のドライバーを読み込みます。 ドライバーがどのようにサポートされるかは、オペレーティングシステムによって異なります。 たとえば、Microsoft® Windows®オペレーティングシステムでは、ドライバーはダイナミックリンクライブラリ (Dll) です。  
  
-   **ODBC では、標準の SQL 文法が定義されています。** ODBC では、標準の呼び出しレベルインターフェイスに加えて、標準の SQL 文法が定義されています。 この文法は、Open Group SQL CAE 仕様に基づいています。 2つの文法の違いは、主に、埋め込み SQL (Open Group) と CLI (ODBC) で必要とされる SQL 文法の違いによるものです。 また、文法には、オープングループの文法でカバーされていない一般的な言語機能を公開するための拡張機能もあります。  
  
     アプリケーションでは、ODBC または DBMS 固有の文法を使用してステートメントを送信できます。 ステートメントで DBMS 固有の文法とは異なる ODBC 文法が使用されている場合、ドライバーはデータソースに送信する前にその文法を変換します。 ただし、ほとんどの Dbms では標準の SQL 文法が既に使用されているため、このような変換はめったに発生しません。  
  
-   **ODBC では、複数の Dbms への同時アクセスを管理するドライバーマネージャーが提供されています。** ドライバーを使用すると、複数の Dbms に同時にアクセスする場合の問題が解決されますが、これを行うコードは複雑になる可能性があります。 すべてのドライバーを使用するように設計されたアプリケーションは、どのドライバーにも静的にリンクすることはできません。 代わりに、実行時にドライバーを読み込み、関数ポインターのテーブルを使用してそれらの関数を呼び出す必要があります。 アプリケーションで複数のドライバーが同時に使用されている場合、状況はさらに複雑になります。  
  
     ODBC では、各アプリケーションに対してこの操作を強制するのではなく、ドライバーマネージャーが提供されます。 ドライバーマネージャーは、すべての ODBC 関数を実装します。ほとんどの場合、ドライバー内の ODBC 関数のパススルー呼び出しとして、アプリケーションに静的にリンクされるか、実行時にアプリケーションによって読み込まれます。 このため、アプリケーションは、ドライバーマネージャーで、各ドライバーのポインターではなく、名前を指定して ODBC 関数を呼び出します。  
  
     アプリケーションが特定のドライバーを必要とする場合、まずドライバーを識別するための接続ハンドルを要求し、ドライバーマネージャーがドライバーを読み込むように要求します。 ドライバーマネージャーはドライバーを読み込み、各関数のアドレスをドライバーに格納します。 ドライバーで ODBC 関数を呼び出すために、アプリケーションはドライバーマネージャーでその関数を呼び出し、ドライバーの接続ハンドルを渡します。 次に、ドライバーマネージャーは、前に格納したアドレスを使用して関数を呼び出します。  
  
-   **ODBC では、多くの DBMS 機能が公開されますが、すべての機能をサポートするドライバーは必要ありません。** ODBC がすべての Dbms に共通する機能のみを公開した場合、使用することはほとんどありません。結局のところ、現在、さまざまな Dbms が存在するのは、機能が異なるためです。 すべての DBMS で利用可能なすべての機能が ODBC で公開されている場合、ドライバーを実装することはできません。  
  
     ODBC では、多くの機能を公開しています。ほとんどの Dbms ではサポートされていませんが、これらの機能のサブセットのみを実装するドライバーを必要とします。 ドライバーは、基になる DBMS でサポートされている場合、またはそのエミュレートを選択した場合にのみ、残りの機能を実装します。 このため、アプリケーションを記述して、DBMS のドライバーによって公開される1つの DBMS の機能を利用したり、すべての Dbms で使用される機能のみを使用したり、特定の機能のサポートを確認し、それに応じて対処したりすることができます。  
  
     ドライバーと dbms がサポートする機能をアプリケーションで判断できるように、ODBC では、ドライバーと DBMS の機能に関する一般的な情報と、ドライバーがサポートする関数の一覧を返す2つの関数 (**SQLGetInfo**および**sqlgetfunctions**) が用意されています。 ODBC では、ドライバーによってサポートされるさまざまな機能を指定する API および SQL 文法準拠レベルも定義します。 詳細については、「[準拠レベル](../../odbc/reference/develop-app/conformance-levels.md)」を参照してください。  
  
     ODBC では、公開されているすべての機能に共通のインターフェイスが定義されていることに注意してください。 このため、アプリケーションには DBMS 固有のコードではなく機能固有のコードが含まれており、これらの機能を公開するすべてのドライバーを使用できます。 この利点の1つは、DBMS でサポートされている機能が強化されたときに、アプリケーションを更新する必要がないことです。その代わりに、更新されたドライバーがインストールされている場合、そのコードは機能固有であり、ドライバー固有または DBMS 固有ではないため、アプリケーションは自動的に機能を使用します。
