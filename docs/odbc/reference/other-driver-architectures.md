---
title: その他のドライバーアーキテクチャ |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- drivers [ODBC], heterogeneous join engines
- drivers [ODBC], ODBC on the server
- ODBC architecture [ODBC], drivers
- heterogeneous join engines[ODBC]
- drivers [ODBC], middle component
ms.assetid: 1cad06ee-5940-4361-8d01-7d850db1dd66
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 8dbfb09a261d7499e07137b7ed830d5a5b92dc73
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2020
ms.locfileid: "68086016"
---
# <a name="other-driver-architectures"></a>その他のドライバーのアーキテクチャ
一部の ODBC ドライバーは、前に説明したアーキテクチャに厳密に準拠していません。 これは、ドライバーが従来の ODBC ドライバー以外の職務を実行しているか、通常の意味ではドライバーではないことが原因である可能性があります。  
  
## <a name="driver-as-a-middle-component"></a>中間コンポーネントとしてのドライバー  
 ODBC ドライバーは、ドライバーマネージャーと、他の1つ以上の ODBC ドライバーの間に存在する場合があります。 中間のドライバーが複数のデータソースを使用できる場合、データソースに実際にアクセスする他のモジュールへの ODBC 呼び出し (または適切に変換された呼び出し) のディスパッチャーとして機能します。 このアーキテクチャでは、中間のドライバーはドライバーマネージャーの役割の一部を占有しています。  
  
 この種のドライバーのもう1つの例は、ODBC 用の spy プログラムです。これにより、ドライバーマネージャーとドライバーの間で送信される ODBC 関数がインターセプトおよびコピーされます。 このレイヤーは、ドライバーまたはアプリケーションをエミュレートするために使用できます。 ドライバーマネージャーに対して、レイヤーはドライバーとして表示されます。ドライバーに対しては、レイヤーはドライバーマネージャーとして表示されます。  
  
## <a name="heterogeneous-join-engines"></a>異種結合エンジン  
 一部の ODBC ドライバーは、異種結合を実行するためのクエリエンジンに基づいて構築されています。 異種結合エンジンの1つのアーキテクチャ (次の図を参照) では、ドライバーはドライバーとしてアプリケーションに表示されますが、アプリケーションとしてドライバーマネージャーの別のインスタンスに表示されます。 このドライバーは、結合された各データベースのドライバーで個別の SQL ステートメントを呼び出すことによって、アプリケーションから異種の結合を処理します。  
  
 ![異種結合エンジンのアーキテクチャ](../../odbc/reference/media/fig3-4.gif "fig3-4")  
  
 このアーキテクチャでは、アプリケーションがさまざまなデータベースのデータにアクセスするための共通のインターフェイスが提供されます。 これは、特殊な列 (行識別子) に関する情報など、メタデータを取得するための一般的な方法を使用できます。また、共通のカタログ関数を呼び出してデータディクショナリ情報を取得することもできます。 たとえば、ODBC 関数**Sqlstatistics**を呼び出すと、テーブルが2つの異なるデータベースにある場合でも、アプリケーションは結合するテーブルのインデックスに関する情報を取得できます。 クエリプロセッサでは、データベースにメタデータが格納される方法について心配する必要はありません。  
  
 アプリケーションには、データ型への標準アクセスもあります。 ODBC では、DBMS 固有のデータ型がマップされる共通の SQL データ型を定義します。 アプリケーションは、 **SQLGetTypeInfo**を呼び出して、異なるデータベースのデータ型に関する情報を取得できます。  
  
 アプリケーションで異種 join ステートメントが生成されると、このアーキテクチャのクエリプロセッサによって SQL ステートメントが解析され、結合する各データベースに対して個別の SQL ステートメントが生成されます。 各ドライバーに関するメタデータを使用することにより、クエリプロセッサは最も効率的でインテリジェントな結合を決定できます。 たとえば、ステートメントが、あるデータベースの2つのテーブルを別のデータベースの1つのテーブルに結合する場合、クエリプロセッサは、一方のデータベースの2つのテーブルを結合してから、他のデータベースのテーブルと結果を結合することができます。  
  
## <a name="odbc-on-the-server"></a>サーバー上の ODBC  
 ODBC ドライバーは、サーバーにインストールして、一連のクライアントコンピューターのアプリケーションで使用できるようにすることができます。 このアーキテクチャ (次の図を参照) では、ドライバーマネージャーと1つの ODBC ドライバーが各クライアントにインストールされ、別のドライバーマネージャーと一連の ODBC ドライバーがサーバーにインストールされます。 これにより、各クライアントは、サーバー上で使用および管理されるさまざまなドライバーにアクセスできるようになります。  
  
 ![サーバー上の ODBC ドライバーのアーキテクチャ](../../odbc/reference/media/fig3-5.gif "FIG3-5")  
  
 このアーキテクチャの利点の1つは、効率的なソフトウェアの保守と構成です。 ドライバーは、サーバー上で1つの場所でのみ更新する必要があります。 システムデータソースを使用すると、すべてのクライアントが使用できるようにデータソースをサーバー上で定義できます。 データソースがクライアントで定義されていない必要があります。 接続プールを使用すると、クライアントがデータソースに接続するプロセスを効率化できます。  
  
 通常、クライアント上のドライバーは、ドライバーマネージャーの呼び出しをサーバーに転送する非常に小さなドライバーです。 サーバー上で完全に機能する ODBC ドライバーよりもフットプリントが大幅に小さくなる可能性があります。 このアーキテクチャでは、サーバーにより多くのコンピューティング能力がある場合、クライアントリソースを解放できます。 さらに、バックアップサーバーをインストールし、負荷分散を実行してサーバーの使用を最適化することで、システム全体の効率とセキュリティを向上させることができます。
