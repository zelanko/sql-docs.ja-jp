---
title: トランザクション ODBC |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transactions [ODBC], about transactions
- transactions [ODBC]
ms.assetid: b4ca861a-c164-4e87-8672-d5de15e3823c
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a40c34b2abeb346c7a718994ba2484bfc728e2b1
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2020
ms.locfileid: "81297957"
---
# <a name="transactions-odbc"></a>トランザクション (ODBC)
*トランザクション*とは、単一のアトミックな操作として実行される作業単位です。つまり、操作は成功または失敗します。 たとえば、ある銀行口座から別の銀行口座に資金を譲渡することを検討してください。 これには、最初のアカウントからの資金の取り出しと2番目のアカウントの購入という2つの手順が含まれます。 両方の手順が成功することが重要です。1つのステップが成功し、もう一方のステップが失敗することは許容されません。 トランザクションをサポートするデータベースは、このことを保証できます。  
  
 トランザクションは、*コミット*されるか*ロールバック*されることで完了できます。 トランザクションがコミットされると、そのトランザクションで行われた変更は永続的になります。 トランザクションがロールバックされると、影響を受ける行は、トランザクションが開始される前の状態に戻ります。 アカウント転送の例を拡張するために、アプリケーションは1つの SQL ステートメントを実行して最初のアカウントをデビットにし、別の SQL ステートメントを実行して2番目のアカウントにクレジットを適用します。 両方のステートメントが成功した場合、アプリケーションはトランザクションをコミットします。 ただし、いずれかのステートメントが何らかの理由で失敗した場合、アプリケーションはトランザクションをロールバックします。 どちらの場合も、アプリケーションはトランザクションの終了時に一貫性のある状態を保証します。  
  
 1つのトランザクションには、異なる時刻に発生する複数のデータベース操作を含めることができます。 他のトランザクションが中間結果に対する完全なアクセス権を持っている場合は、トランザクションが相互に干渉する可能性があります。 たとえば、あるトランザクションが行を挿入し、2番目のトランザクションがその行を読み取り、最初のトランザクションがロールバックされたとします。 2番目のトランザクションには、存在しない行のデータが含まれるようになりました。  
  
 この問題を解決するには、トランザクションを相互に分離するためのさまざまなスキームがあります。 *トランザクション分離*は通常、行をロックすることによって実装されます。これにより、複数のトランザクションが同時に同じ行を使用するのを防ぐことができます。 一部のデータベースでは、行のロックによって他の行がロックされることもあります。  
  
 トランザクション分離の増加により *、同時実行性*が低下します。また、2つのトランザクションが同時に同じデータを使用できるようになります。 詳細については、「[トランザクション分離レベルの設定](../../../odbc/reference/develop-app/setting-the-transaction-isolation-level.md)」を参照してください。  
  
 このセクションでは、次のトピックを扱います。  
  
-   [ODBC でのトランザクション](../../../odbc/reference/develop-app/transactions-in-odbc-odbc.md)  
  
-   [トランザクション分離](../../../odbc/reference/develop-app/transaction-isolation.md)  
  
-   [同時実行制御](../../../odbc/reference/develop-app/concurrency-control.md)
