---
title: 共有データ ソースを作成、変更、および削除する (SSRS) | Microsoft Docs
ms.date: 05/24/2018
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-data
ms.topic: conceptual
helpviewer_keywords:
- modifying data source properties
- shared data sources [Reporting Services]
- removing shared data sources
- roles [Reporting Services], shared data sources
- data sources [Reporting Services], shared
- data sources [Reporting Services], modifying properties
- deleting shared data sources
ms.assetid: 1e58c1c2-5ecf-4ce6-9d04-0a8acfba17be
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 1045f9a0c271ee4c3befe434a3eef50f0edee6df
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MTE75
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "65573208"
---
# <a name="create-modify-and-delete-shared-data-sources-ssrs"></a>共有データ ソースを作成、変更、および削除する (SSRS)
  共有データ ソースは、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] レポート サーバーで実行される複数のレポート、モデル、およびデータ ドリブン サブスクリプションから参照できる一連のデータ ソース接続プロパティの集まりです。  共有データ ソースを使用することで、時間の経過に伴って変更されることの多いデータ ソースのプロパティを容易に管理できます。 ユーザーのアカウントまたはパスワードが変更された場合や、データベースを別のサーバーに移動した場合は、接続情報を 1 か所で更新できます。  
  
 共有データ ソースは、レポートおよびデータ ドリブン サブスクリプションでは省略可能ですが、レポート モデルでは必須です。 カスタム レポート用のレポート モデルを使用する予定がある場合は、そのモデルへの接続情報を提供する共有データ ソース アイテムを作成および管理する必要があります。  
  
 共有データ ソースは、次の要素で構成されます。  
  
|要素|[説明]|  
|----------|-----------------|  
|[オブジェクト名]|レポート サーバーのフォルダー階層内にあるアイテムを識別する名前。|  
|[説明]|Web ポータルでフォルダーの内容を参照したときに、アイテムと共に表示される説明です。|  
|接続の種類|データ ソースで使用するデータ処理拡張機能です。 レポート サーバーに配置されているデータ処理拡張機能のみ使用できます。 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] に含まれているデータ処理拡張機能については、「[Reporting Services でサポートされるデータ ソース &#40;SSRS&#41;](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md)」を参照してください。|  
|[接続文字列]|データベースの接続文字列です。 よく使われるデータ ソースの接続文字列の詳細と例を確認するには、「 [データ接続、データ ソース、および接続文字列 (レポート ビルダーおよび SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)」を参照してください。|  
|資格情報の種類|接続に必要な資格情報をどのように取得するか、および、接続の確立後もそれらを使用するかどうかを指定します。 詳細については、「 [レポート データ ソースに関する資格情報と接続情報を指定する](../../reporting-services/report-data/specify-credential-and-connection-information-for-report-data-sources.md)」をご覧ください。|  
  
 共有データ ソースには、データの取得に使用するクエリ情報が含まれません。 クエリは、常にレポート定義内に保持されます。  
  
## <a name="creating-and-modifying-shared-data-sources"></a>共有データ ソースの作成と変更  
 共有データ ソースの作成や、そのプロパティの変更を行うには、レポート サーバーにおける **データ ソースの管理** 権限が必要です。 レポート サーバーをネイティブ モードで実行している場合は、Web ポータルで共有データ ソースの作成と構成を行うことができます。 レポート サーバーを SharePoint 統合モードで実行している場合は、SharePoint サイトのアプリケーション ページを使用できます。 モードに関係なくどのレポート サーバーでも、レポート デザイナーで共有データ ソースを作成し、それをターゲット サーバーにパブリッシュできます。  
  
 レポート サーバーに共有データ ソースを作成した後は、その共有データ ソースに対するアクセスを制御するためのロール割り当てを作成できるほか、共有データ ソースを別の場所に移動したり、名前を変更したりできます。また、外部データ ソースでメンテナンス操作を実行しているときに、共有データ ソースをオフラインにして、レポート処理が行われないようにすることもできます。 共有データ ソース アイテムの名前を変更したり、レポート サーバーのフォルダー階層内の別の場所に共有データ ソース アイテムを移動すると、共有データ ソースを参照するすべてのレポートまたはサブスクリプションのパス情報が適宜更新されます。 共有データ ソースをオフラインにした場合、再度データ ソースを有効にするまで、レポート、モデル、およびサブスクリプションはすべて実行されなくなります。  
  
 レポート サーバーのフォルダー階層で共有データ ソースへのアクセスを制御する方法の詳細については、「 [共有データ ソース アイテムをセキュリティで保護する](../../reporting-services/security/secure-shared-data-source-items.md)」を参照してください。  
  
 **レポート デザイナーで共有データ ソースを作成するには**  
  
1.  ツール バーのレポート データ ペインで、 **[新規作成]** 、 **[データ ソース]** の順にクリックします。 **[データ ソースのプロパティ]** ダイアログ ボックスが表示されます。  
  
    > [!NOTE]  
    >  レポート データ ペインが表示されていない場合は、 **[表示]** メニューの **[レポート データ]** をクリックします。  
  
2.  **[名前]** ボックスにデータ ソースの名前を入力するか、既定値をそのまま使用します。 データ ソース名は、レポートの内部で使用されます。 判別がつきやすいように、データ ソース名には、接続文字列に指定するデータベース名を含めることをお勧めします。  
  
3.  **[共有データ ソース参照を使用する]** が選択されていることを確認し、次の操作を行います。  
  
    1.  **[新規作成]** をクリックします。 **[共有データ ソース]** のプロパティ ダイアログ ボックスで、手順 2. および 3. を実行して新規データ ソースを作成します。  
  
    2.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
         ソリューション エクスプローラーの [共有データ ソース] フォルダーに、新しい共有データ ソースが表示されます。  
  
4.  **[資格情報]** をクリックします。  
  
     このデータ ソースに使用する資格情報を指定します。 サポートされる資格情報の種類は、データ ソースの所有者によって選択されます。  
  
 **Web ポータルで共有データ ソースを作成するには**  
  
1.  Web ポータルで、 **[新規]**  >  **[データ ソース]** の順に選択します。 
  
4.  アイテムの名前を入力します。 名前は 1 文字以上で、文字で始まる必要があります。 特定の記号を含めることもできますが、スペースまたは ; ? : \@ & = + , $ / * < > | " /.  
  
5.  必要に応じて説明を入力し、接続に関する情報をユーザーに提供します。  
  
6.  **[データ ソースの種類]** の一覧で、データ ソースから取得したデータの処理に使用するデータ処理拡張機能を指定します。  
  
7.  **[接続文字列]** でレポート サーバーがデータ ソースへの接続に使用する接続文字列を指定します。 接続文字列に資格情報を指定しないことをお勧めします。  
  
     以下に、ローカルの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] AdventureWorks2016 データベースへの接続に使用する接続文字列の例を示します。  
  
    ```  
    data source=<localservername>; initial catalog=AdventureWorks2016 
    ```  
  
8.  **[接続に使用する認証]** では、レポートが実行される際に資格情報を取得する方法を指定します。  
  
    -   ユーザーにログオン名とパスワードを要求する場合は、 **[レポートの実行者により指定された資格情報]** をクリックします。 ユーザーが入力する資格情報を Windows 資格情報として使用するには、 **[データ ソースへの接続時に Windows 資格情報として使用する]** をクリックします。 ユーザー名とパスワードがデータベースの資格情報である場合は、このオプションを選択しないでください。  
  
    -   データ ソースの使用目的が、保存された資格情報によって所有者が管理する共有データ ソースとしての使用や、サブスクリプションやその他のスケジュール設定された操作 (自動レポート履歴生成など) をサポートするレポートでの使用である場合は、 **[レポート サーバーに保存され、セキュリティで保護された資格情報]** をクリックします。 データベース サーバーが権限の借用または委譲をサポートしている場合は、 **[データ ソースへの接続が確立した後に、認証されているユーザーの権限を借用する]** を選択できます。  
  
    -   レポート サーバーが、レポートにアクセスするユーザーの資格情報を、外部データ ソースをホストするサーバーに渡す場合は、 **[Windows 統合セキュリティ]** をクリックします。 この場合、ユーザーはユーザー名やパスワードを入力することを要求されません。  
  
    -   データ ソースで資格情報を使用しない場合 (ファイル システムからアクセス可能な XML ファイルをデータ ソースとして使用する場合など) は、 **[資格情報は必要ありません]** をクリックします。 この資格情報オプションは、使用するデータ ソースで妥当と考えられる場合にのみ指定してください。 認証を必要とするデータ ソースに対してこのオプションを選択した場合、接続エラーが発生します。 このオプションを選択する場合は、ユーザーの資格情報を利用できない場合に、レポート サーバーが他のコンピューターに接続して、データまたはファイルを取得できるように、必ず自動実行アカウントを構成してください。  
  
         資格情報の構成の詳細については、「 [レポート データ ソースに関する資格情報と接続情報を指定する](../../reporting-services/report-data/specify-credential-and-connection-information-for-report-data-sources.md)」を参照してください。 自動実行アカウントについては、「[自動実行アカウントの構成 &#40;SSRS 構成マネージャー&#41;](../../reporting-services/install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)」を参照してください。  
  
9. データ ソース構成を検証するには、 **[接続テスト]** をクリックします。  
  
    > [!NOTE]  
    >  [接続テスト] ボタンは、XML データ ソースの種類ではサポートされません。  
  
10. **[OK]** をクリックします。  
  
 **Web ポータルで共有データ ソースを変更するには**  
  
1.  Web ポータルで、共有データ ソースに移動します。  
  
2.  共有データ ソースの右上隅にある省略記号 (...)、 **[管理]** の順に選択します。   

    **[プロパティ]** ページを開きます。
  
3.  データ ソースを変更し、 **[適用]** をクリックします。  
  
## <a name="deleting-shared-data-sources"></a>共有データ ソースの削除  
 共有データ ソースは、レポート サーバーからアイテムを削除するときと同じ方法で削除できます。  
  
 **共有データ ソースを削除するには**  
  
1. Web ポータルで、共有データ ソースに移動します。  
  
2.  共有データ ソースの右上隅にある省略記号 (...)、 **[管理]** の順に選択します。    
    **[プロパティ]** ページを開きます。
  
3. **[削除]** をクリックして、 **[OK]** をクリックします。  
  
共有データ ソースを削除すると、それを使用しているレポート、モデル、またはデータ ドリブン サブスクリプションがすべて非アクティブ化されます。 データ ソース接続情報がなければ、アイテムを実行することはできません。 これらのアイテムをアクティブ化するには、各アイテムを開いて、以下の操作を行います。  
  
-   共有データ ソースを参照するレポートおよびデータ ドリブン サブスクリプションの場合は、レポートのプロパティまたはサブスクリプションでデータ ソース接続情報を指定するか、必要な値が設定された新しい共有データ ソースを選択できます。  
  
-   モデルや、そのモデルを使用するレポート ビルダー レポートの場合は、新しい共有データ ソースを指定する必要があります。 モデルでは、データ ソース接続情報が、共有データ ソースからのみ取得されます。  
  
 共有データ ソースの削除操作を元に戻すことはできません。 ただし、共有データ ソースをうっかり削除してしまったとしても、削除したデータ ソースと同じプロパティ値で新たに作成し直すことは可能です。 レポート、モデル、またはデータ ドリブン サブスクリプションを 1 つずつ開いて、共有データ ソースと、それを使用しているアイテムとを再バインドする必要はありますが、データ ソースのプロパティが以前と同じであれば、引き続き以前と同じようにそれらを使用できます。  
  
## <a name="importing-shared-data-sources"></a>共有データ ソースのインポート  

**レポート デザイナーで既存のデータ ソースをインポートするには**  
  
1.  ソリューション エクスプローラーで、レポート サーバー プロジェクトの **[共有データ ソース]** フォルダーを右クリックして、 **[既存項目の追加]** をクリックします。 **[既存項目の追加]** ダイアログ ボックスが表示されます。  
  
2.  既存のレポート定義共有データ ソース (rds) ファイルを参照して、 **[開く]** をクリックします。  
  
3.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
## <a name="shared-data-sources-in-sharepoint"></a>SharePoint 内の共有データ ソース  
 SharePoint ライブラリからレポートを実行する場合は、レポート内で、またはそのレポートにリンクされている外部ファイルで、接続情報を定義できます。 レポートに埋め込む接続情報をカスタム データ ソースと呼びます。 外部ファイル内で定義する接続情報を共有データ ソースと呼びます。 外部ファイルとしては、レポート サーバー データ ソース (.rsds) ファイルまたは Office データ接続 (.odc) ファイルを使用できます。  
  
 .rsds ファイルは、.rds ファイルと似ていますが、スキーマが異なります。 .rsds ファイルを作成するには、レポート デザイナーまたはモデル デザイナーから SharePoint ライブラリに .rds をパブリッシュできます (新しい .rsds ファイルが元の .rds ファイルから作成されます)。 または、SharePoint サイトのライブラリに新しいファイルを作成することもできます。  
  
 共有データ ソースを作成またはパブリッシュした場合は、後で接続プロパティを編集したり、使用されなくなったファイルを削除することができます。 共有データ ソースを削除する前に、共有データ ソースがレポートおよびレポート モデルによって使用されているかどうかを判断する必要があります。 共有データ ソースを参照している依存アイテムを表示することによって、この操作を行えます。  
  
 依存アイテムの一覧では、共有データ ソースが参照されているかどうかを確認することはできますが、アイテムがアクティブに使用されているかどうかは確認できません。 共有データ ソースまたはモデルが実際に使用されているかどうかを判断するには、レポート サーバー コンピューターのログ ファイルを調べます。 ログ ファイルへのアクセス許可がない場合や、ログ ファイルに必要な情報が記載されていない場合は、レポートの現状を確認する間、アクセスを受ける心配のないフォルダーにそのレポートを移動することを検討します。  
  
 **共有データ ソース (.rsds) ファイルを作成するには (SharePoint 2010)**  
  
1.  ライブラリ リボンで、 **[ドキュメント]** タブをクリックします。  
  
2.  **[新しいドキュメント]** メニューの **[レポート データ ソース]** をクリックします。  
  
    > [!NOTE]  
    >  メニューに **[レポート データ ソース]** アイテムが表示されない場合は、レポート データ ソースのコンテンツ タイプが有効化されていません。 詳細については、「 [SharePoint ライブラリへの Reporting Services のコンテンツの種類の追加](../../reporting-services/report-server-sharepoint/add-reporting-services-content-types-to-a-sharepoint-library.md)」を参照してください。  
  
3.  **[名前]** に、.rsds ファイルに付けるわかりやすい名前を入力します。  
  
4.  **[データ ソースの種類]** で、一覧からデータ ソースの種類を選択します。 詳細については、「[Reporting Services でサポートされるデータ ソース &#40;SSRS&#41;](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md)」をご覧ください。  
  
5.  **[接続文字列]** で、外部データ ソースへの接続を確立するために必要な設定として、データ ソースへのポインターなどを指定します。 使用するデータ ソースの種類によって、接続文字列の構文が異なります。 詳細と例については、「 [データ接続、データ ソース、および接続文字列 (レポート ビルダーおよび SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)」を参照してください。  
  
6.  **[資格情報]** で、外部データ ソースにアクセスする際にレポート サーバーが資格情報を取得する方法を指定します。 資格情報は、自動レポート処理用に保存、要求、統合、または構成できます。  
  
    -   レポートを開いたユーザーの資格情報を使用してデータにアクセスする場合は、 **[Windows 認証 (統合)]** を選択します。 SharePoint サイトまたはファームでフォーム認証を使用する場合や、信頼済みアカウントを使用してレポート サーバーに接続する場合は、このオプションを選択しないでください。 このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。 Kerberos 認証が有効なドメインに参加している場合、またはレポート サーバーと同一のコンピューターにデータ ソースがある場合に、このオプションは最適です。 Kerberos 認証が無効になっている場合、Windows 資格情報は別のコンピューター 1 台にしか渡すことができません。 つまり、外部データ ソースが別のコンピューターにあり、別の接続が必要な場合、意図したデータを取得できずにエラーが発生します。  
  
    -   ユーザーがレポートを実行するたびに資格情報の入力を要求する場合は、 **[資格情報を要求する]** をクリックします。 このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。  
  
    -   1 組の資格情報を使用してデータにアクセスする場合は、 **[保存された資格情報]** を選択します。 資格情報は暗号化されてから保存されます。 保存されている資格情報の認証方法を指定するオプションを選択できます。 保存された資格情報が Windows ユーザー アカウントに属する場合は、[データ ソースへの接続時に Windows 資格情報として使用する] をクリックします。 データベース サーバーの実行コンテキストを設定する場合は、 **[実行コンテキストをこのアカウントに設定する]** をクリックします。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベースの場合、このオプションによって SETUSER 関数が設定されます。 詳細については、「[SETUSER &#40;Transact-SQL&#41;](../../t-sql/statements/setuser-transact-sql.md)」を参照してください。  
  
    -   接続文字列で資格情報を指定する場合や、レポート サーバーで構成されている最小特権アカウントを使用してレポートを実行する場合は、 **[資格情報は必要ありません]** を選択します。 レポート サーバーでこのアカウントが構成されていない場合、ユーザーは資格情報の入力を要求され、そのレポート用に定義したスケジュール済みの操作は実行されません。  
  
7.  データ ソースをアクティブにする場合は、 **[このデータ ソースを有効にする]** を選択します。 データ ソースが構成されていてもアクティブでない場合は、ユーザーがそのデータ ソースに基づくレポートを使用しようとするとエラー メッセージが表示されます。  
  
8.  データ ソース構成を検証するには、 **[接続テスト]** をクリックします。  
  
    > [!NOTE]  
    >  [接続テスト] ボタンは、XML データ ソースの種類ではサポートされません。  
  
9. **[OK]** をクリックして、共有データ ソースを作成します。  
  
 **共有データ ソース (.rsds) ファイルを削除するには**  
  
1.  .rsds ファイルを含むライブラリを開きます。  
  
2.  共有データ ソースをポイントします。  
  
3.  クリックして下矢印を表示し、 **[削除]** を選択します。  
  
 保存しておく必要のある共有データ ソースを誤って削除した場合は、同じ接続情報が含まれた新しい共有データ ソースを作成できます。 共有データ ソースを作成し直した後、そのデータ ソースを使用していたレポートおよびモデルをすべて開き、新しい共有データ ソースを選択する必要があります。 新しい共有データ ソース アイテムには、削除した共有データ ソースとは異なる名前、資格情報、または接続文字列構文を指定できます。 接続が同一のデータ ソースに解決される限り、データ ソースのプロパティが元の値と異なっても問題ありません。  
  
 レポート モデルを削除するときは注意してください。 モデルを削除すると、そのモデルを基にしているレポートをレポート ビルダーで開いて変更することができなくなります。 既存のレポートによって使用されているモデルを誤って削除した場合は、そのモデルを再生成し、そのモデルを使用するレポートの再作成と保存を行って、使用するモデル アイテム セキュリティを再指定する必要があります。 モデルを生成し直して既存のレポートに関連付けるだけでは元の状態に戻りません。  
  
## <a name="dependent-items"></a>依存アイテム  
 特定のデータ ソースを使用しているレポートおよびモデルの一覧を表示するには、共有データ ソースの [依存アイテム] ページを開きます。 このページには、Web ポータルまたは SharePoint のアプリケーション ページでデータ ソースを開くことによってアクセスできます。 [依存アイテム] ページにはデータ ドリブン サブスクリプションが表示されない点に注意してください。 共有データ ソースがサブスクリプションで使用されている場合、[依存アイテム] の一覧には、そのサブスクリプションが表示されません。  
  
 **SharePoint で依存アイテムを表示するには**  
  
1.  .rsds ファイルを含むライブラリを開きます。  
  
2.  共有データ ソースをポイントします。  
  
3.  クリックして下矢印を表示し、 **[依存アイテムの表示]** を選択します。  
  
     レポート モデルの依存アイテムの一覧には、レポート ビルダーで作成したレポートが表示されます。 共有データ ソースの依存アイテムの一覧には、レポートとレポート モデルの両方が表示される場合があります。  
  
## <a name="see-also"></a>参照  
 [データ接続、データ ソース、および接続文字列 &#40;レポート ビルダーおよび SSRS&#41;](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)   
 [レポート データ ソースを管理する](../../reporting-services/report-data/manage-report-data-sources.md)   
 [ページ分割されたレポートのデータ ソースのプロパティを構成する](../../reporting-services/report-data/configure-data-source-properties-for-a-report-report-manager.md)  
  
  
