---
description: チュートリアル:OData ソースの使用
title: 'チュートリアル: OData ソースの使用 | Microsoft Docs'
ms.custom: ''
ms.date: 03/01/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 2c64cf8b-5edb-48df-8ffe-697096258f71
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e12fe80482b6b6ffd96fe6e56e6dfad1a92362fc
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2020
ms.locfileid: "88425674"
---
# <a name="tutorial-using-the-odata-source"></a>チュートリアル:OData ソースの使用

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  このチュートリアルでは、サンプルの **Northwind** OData サービス (https://services.odata.org/V3/Northwind/Northwind.svc/)) から **Employees** (従業員) コレクションを抽出し、フラット ファイルに読み込むプロセスについて説明します。  
  
## <a name="1-create-an-integration-services-project"></a>1.Integration Services プロジェクトの作成  
  
1.  **SQL Server Data Tools** または [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]を起動します。  
  
2.  **[ファイル]** をクリックし、 **[新規作成]** をポイントして、 **[プロジェクト]** をクリックします。  
  
3.  **[新しいプロジェクト]** ダイアログ ボックスで **[インストール済み]**、 **[テンプレート]**、 **[ビジネス インテリジェンス]** の順に展開し、 **[Integration Services]** をクリックします。  
  
4.  プロジェクトの種類として、 **[Integration Services プロジェクト]** をクリックします。  
  
5.  プロジェクトの **[名前]** を入力し、 **[場所]** を選択して、 **[OK]** をクリックします。  
  
## <a name="2-add-and-configure-an-odata-source"></a>2.OData ソースの追加と構成 
  
1.  **[SSIS ツールボックス]** の **[データ フロー タスク]** を、SSIS パッケージの制御フロー デザイン画面にドラッグ アンド ドロップします。  
  
2.  **[データ フロー]** タブをクリックするか、**[データ フロー タスク]** をダブルクリックして、[データ フロー] デザイン画面を開きます。  
  
3.  **[SSIS ツールボックス]** の **[共通]** から **[OData ソース]** をドラッグ アンド ドロップします。
  
4.  **OData ソース** コンポーネントをダブルクリックして、**[OData ソース エディター]** ダイアログ ボックスを起動します。  
  
5.  **[新規]** をクリックし、新しい OData 接続マネージャーを追加します。  
  
6.  **[サービス ドキュメントの場所]** に対応する OData サービスの URL を入力します。 この URL には、サービス ドキュメントに対応する URL、または特定のフィードかエンティティに対応する URL を指定できます。 このチュートリアルでは、サービス ドキュメントへの URL ([https://services.odata.org/V3/Northwind/Northwind.svc/](https://services.odata.org/V3/Northwind/Northwind.svc/)) を入力します。  
  
7.  OData サービスにアクセスするために、 **[認証]** で **[Windows 認証]** が選択されていることを確認します。 既定では、**[Windows 認証]** が選択されています。  
  
8.  **[接続テスト]** をクリックして接続をテストし、**[OK]** をクリックして OData 接続マネージャーのインスタンスの作成を完了します。  
  
9. **[OData ソース エディター]** ダイアログ ボックスの **[リソースのパスでコレクションを使用する]** オプションで **[コレクション]** が選択されていること確認します。  
  
10. **[コレクション]** ドロップダウン リストで、**[Employees]** を選択します。  
  
11. **[クエリ オプション]** で、追加の OData クエリ オプションまたはフィルターを入力します。 たとえば、「 `$orderby=CompanyName&$top=100` 」のように入力します。 このチュートリアルでは、「`$top=5`」と入力します。  
  
12. **[プレビュー]** をクリックして、データをプレビューします。  
  
13. 左側のナビゲーション ウィンドウで **[列]** をクリックし、 **[列]** ページに切り替えます。  
  
14. **[使用できる外部列]** で **[EmployeeID]**、 **[FirstName]** 、 **[LastName]** の各チェック ボックスをオンにし、これらを選択します。  
  
15. **[OK]** をクリックし、 **[OData ソース エディター]** ダイアログ ボックスを閉じます。  
  
## <a name="3-add-and-configure-a-flat-file-destination"></a>3.フラット ファイル変換先の追加と構成
  
1.  今度は、 **[SSIS ツールボックス]** の **[フラット ファイル変換先]** を、 **[OData ソース]** コンポーネントの下にある [データ フロー] デザイン画面にドラッグ アンド ドロップします。  
  
2.  青い矢印を使用して、 **[OData ソース]** コンポーネントを **[フラット ファイル変換先]** コンポーネントに接続します。  
  
3.  **[フラット ファイル変換先]** をダブルクリックします。 **[フラット ファイル変換先エディター]** ダイアログ ボックスが表示されます。  
  
4.  **[フラット ファイル変換先エディター]** ダイアログ ボックスで **[新規]** をクリックし、新しいフラット ファイル接続マネージャーを作成します。  
  
5.  **[フラット ファイル形式]** ダイアログ ボックスで、 **[区切り記号]** を選択します。 その後、**[フラット ファイル接続マネージャー エディター]** ダイアログ ボックスが表示されます。  
  
6.  **[フラット ファイル接続マネージャー エディター]** ダイアログ ボックスの **[ファイル名]** で、「`c:\Employees.txt`」と入力します。  
  
7.  左側のナビゲーション ウィンドウで、 **[列]** をクリックします。 このページで、データをプレビューできます。  
  
8.  **[OK]** をクリックして、[ファイル接続マネージャー エディター] ダイアログ ボックスを閉じます。  
  
9. **[フラット ファイル変換先エディター]** ダイアログ ボックスにある左側のナビゲーション ウィンドウで **[マッピング]** をクリックします。 マッピングを確認します。  
  
10. [OK] をクリックして、 **[フラット ファイル変換先エディター]** ダイアログ ボックスを閉じます。  

## <a name="4-run-the-package"></a>4.パッケージの実行
SSIS パッケージを実行します。 OData フィードから得られた 5 人の従業員の ID、名、姓を使用して出力ファイルが作成されたことを確認します。
  
  
