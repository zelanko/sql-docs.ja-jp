---
title: テーブルまたはマトリックスへの対話的な並べ替えの追加 (レポート ビルダーおよび SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10121"
- sql12.rtp.rptdesigner.textboxproperties.intrctvsort.f1
ms.assetid: 05819637-729b-4cf6-82de-91a99f184ec6
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 961a2a76f2a839ccc9fa8fb90027bec180d870d6
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66106643"
---
# <a name="add-interactive-sort-to-a-table-or-matrix-report-builder-and-ssrs"></a>テーブルまたはマトリックスへの対話的な並べ替えの追加 (レポート ビルダーおよび SSRS)
  ユーザーがテーブルやマトリックス内で行と列の並べ替え順序を変更できるようにするには、対話的な並べ替えボタンを追加します。 この機能は、ユーザーとの対話が可能な、HTML などの表示形式でのみサポートされています。  
  
 対話的な並べ替えボタンを作成する場合は、並べ替えの対象、並べ替え基準、および並べ替えの適用範囲を指定する必要があります。 たとえば、詳細行を顧客名ごとに並べ替えたり、カテゴリ グループ内のサブカテゴリ グループ値を売上順に並べ替えたり、カテゴリ グループ値とサブカテゴリ グループ値を合計に基づいて並べ替えたりできます。  
  
 レポートを表示すると、対話的な並べ替えをサポートする列には、並べ替え順序に応じて方向が変わる矢印のアイコンが表示されます。 対話的な並べ替えボタンを初めてクリックすると、アイテムは昇順に並べ替えられます。 2 回目以降は、ボタンをクリックするたびに昇順と降順が切り替わります。  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="BackToTop"></a> この記事の内容  
 [グループのないテーブルの詳細行の並べ替え](#SortingDetailRows)  
  
 [テーブルまたはマトリックスの最上位レベル親行グループの並べ替え](#SortingTopLevelParent)  
  
 [グループの子グループまたは詳細行の並べ替え](#SortingChildGroups)  
  
 [複雑なグループ式に基づく行の並べ替え](#SortingMultipleRowGroups)  
  
 [複数のデータ領域の並べ替え順序の同期](#SynchronizingSortOrder)  
  
##  <a name="SortingDetailRows"></a> グループのないテーブルの詳細行の並べ替え  
 ユーザーが列見出しをクリックすることにより、その列に表示されている値に基づいてテーブル内の詳細行を並べ替えられるようにするには、対話的な並べ替えボタンを列見出しに追加します。  
  
#### <a name="to-add-an-interactive-sort-button-to-a-column-header-to-sort-the-table-by-value"></a>テーブルを値で並べ替えるための対話的な並べ替えボタンを列見出しに追加するには  
  
1.  レポート デザイン ビュー内のグループのないテーブルで、対話的な並べ替えボタンを追加する列見出しにあるテキスト ボックスを右クリックして、 **[テキスト ボックスのプロパティ]** をクリックします。  
  
2.  **[対話的な並べ替え]** をクリックします。  
  
3.  **[このテキスト ボックスでの対話的な並べ替えを有効にする]** を選択します。  
  
4.  **[並べ替えの対象の選択]** で、 **[詳細行]** をクリックします。  
  
5.  **[並べ替え]** で、並べ替え式を指定します。 ドロップダウン リストから、並べ替えアクションを定義する列に対応するフィールドを選択します (たとえば、"Title" という列見出しの場合は、" `[Title]`" を選択)。 並べ替え式の指定は必須です。  
  
6.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
7.  対話的な並べ替えボタンを追加する列ごとに、手順 1. ～ 6. を繰り返します。  
  
 並べ替えアクションを確認するには、 **[実行]** をクリックしてレポートをプレビューし、対話的な並べ替えボタンをクリックします。  
  
 ![[トップに戻る] リンクで使用される矢印アイコン](../../2014-toc/media/uparrow16x16.gif "[トップに戻る] リンクで使用される矢印アイコン") [トップに戻る](#BackToTop)  
  
##  <a name="SortingTopLevelParent"></a> テーブルまたはマトリックスの最上位レベル親行グループの並べ替え  
 ユーザーが列見出しをクリックすることにより、その列に表示されている値に基づいてテーブルまたはマトリックス内の親グループ行を並べ替えられるようにするには、対話的な並べ替えボタンを列見出しに追加します。 子グループの順序は変更されません。  
  
#### <a name="to-add-an-interactive-sort-button-to-a-column-header-to-sort-groups"></a>グループを並べ替えるための対話的な並べ替えボタンを列見出しに追加するには  
  
1.  レポート デザイン ビュー内のテーブルまたはマトリックスで、対話的な並べ替えボタンを追加するグループの列見出しにあるテキスト ボックスを右クリックして、 **[テキスト ボックスのプロパティ]** をクリックします。  
  
2.  **[対話的な並べ替え]** をクリックします。  
  
3.  **[このテキスト ボックスでの対話的な並べ替えを有効にする]** を選択します。  
  
4.  **[並べ替えの対象の選択]** で、 **[グループ]** をクリックします。  
  
5.  ドロップダウン リストから、並べ替えるグループの名前を選択します。 単一のグループ式に基づくグループの場合は、 **[並べ替え]** にグループ式が自動的に入力されます。  
  
    > [!NOTE]  
    >  複雑なグループ式の場合は、 **[並べ替え]** をグループ式と同じ値に手動で設定してください。  
  
6.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
 並べ替えアクションを確認するには、 **[実行]** をクリックしてレポートをプレビューし、対話的な並べ替えボタンをクリックします。  
  
 ![[トップに戻る] リンクで使用される矢印アイコン](../../2014-toc/media/uparrow16x16.gif "[トップに戻る] リンクで使用される矢印アイコン") [トップに戻る](#BackToTop)  
  
##  <a name="SortingChildGroups"></a> グループの子グループまたは詳細行の並べ替え  
 ユーザーが親グループ内の子グループの値を並べ替えたり、最も内側にある子グループの詳細行を並べ替えたりできるようにするには、対話的な並べ替えボタンをグループ ヘッダー行に追加します。  
  
#### <a name="to-add-an-interactive-sort-button-to-a-text-box-in-a-group-row-header-to-sort-child-groups-or-detail-rows"></a>子グループまたは詳細行を並べ替えるための対話的な並べ替えボタンをグループ行ヘッダーのテキスト ボックスに追加するには  
  
1.  レポート デザイン ビューで、対話的な並べ替えボタンを追加するグループ ヘッダー行にあるテキスト ボックスを右クリックして、 **[テキスト ボックスのプロパティ]** をクリックします。  
  
2.  **[対話的な並べ替え]** をクリックします。  
  
3.  **[このテキスト ボックスでの対話的な並べ替えを有効にする]** を選択します。  
  
4.  **[並べ替えの対象の選択]** で、以下のいずれかのオプションをクリックします。  
  
    -   **[詳細]** 詳細行を並べ替えるには、 **[詳細]** をクリックします。 ドロップダウン リストから、並べ替えの基準にするフィールドを選択します。 このオプションを選択した場合は、並べ替えの基準にする値を指定する必要があります。  
  
    -   **[グループ]** 子グループの値を並べ替えるには、 **[グループ]** をクリックします。 このオプションを選択した場合、 **[並べ替え]** には、グループ式が自動的に入力されます。  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
 並べ替えアクションを確認するには、 **[実行]** をクリックしてレポートをプレビューし、対話的な並べ替えボタンをクリックします。  
  
 ![[トップに戻る] リンクで使用される矢印アイコン](../../2014-toc/media/uparrow16x16.gif "[トップに戻る] リンクで使用される矢印アイコン") [トップに戻る](#BackToTop)  
  
##  <a name="SortingMultipleRowGroups"></a> 複雑なグループ式に基づく行の並べ替え  
 ユーザーが列見出しをクリックすることにより、親グループと子グループの組み合わせを並べ替えられるようにするには、対話的な並べ替えボタンを列見出しに追加します。 この機能を実現するには、両方のグループを複合したものにグループ式を変更する必要があります。 たとえば、ある店舗の在庫合計を表示するマトリックスがあり、色とサイズの両方でアイテムがグループ化されているとします。 この場合に、色とサイズの組み合わせに基づいて行を並べ替えるには、色とサイズのグループを別々に定義するのではなく、色とサイズの組み合わせに基づいたグループを 1 つ定義します。 グループ式の定義の詳細については、「[グループ式の例 &#40;レポート ビルダーおよび SSRS&#41;](expression-examples-report-builder-and-ssrs.md)」を参照してください。  
  
 次の手順では、Tablix データ領域部分を指定する用語が使用されています。 詳細については、「[Tablix データ領域部分 &#40;レポート ビルダーおよび SSRS&#41;](tablix-data-region-areas-report-builder-and-ssrs.md)」を参照してください。  
  
 通常、複数のグループに基づいて行を並べ替える場合は、列グループにかかわらず、並べ替えられた行の合計を表示することが必要となります。 この手順では、列グループが使用されません。 まず、マトリックスを追加して、既定の列グループを削除します。 または、テーブルを追加して、詳細グループを削除することもできます。  
  
#### <a name="to-add-an-interactive-sort-button-to-a-column-header-to-sort-multiple-groups"></a>複数のグループを並べ替えるための対話的な並べ替えボタンを列見出しに追加するには  
  
1.  レポート デザイン ビューで、マトリックスを追加します。  
  
2.  数値フィールドをデータ セルにドラッグして、データセットとマトリックスを関連付けます。  
  
     次に、複数のフィールドを指定するグループ式、およびグループ値の表示に使用するグループ ヘッダーを作成します。  
  
3.  マトリックスがデザイン画面で選択されていることを確認します。 グループ化ペインに、既定の行グループと列グループが表示されます。  
  
4.  行グループ ペインで、既定の行グループを右クリックし、 **[グループの編集]** をクリックします。 **[グループのプロパティ]** ダイアログ ボックスが表示されます。  
  
5.  **[名前]** で、グループ化する複数のグループを指定する名前で、既定の名前を置換します。  
  
6.  **[グループ式]** の **[グループ化の条件]** で、式 ( **[fx]** ) ボタンをクリックして **[式]** ダイアログ ボックスを開きます。  
  
7.  グループ化するすべてのフィールドを指定する式を入力します。 たとえば、グループ式 `=Fields!Color.Value & Fields!Size.Value`では、Color というフィールドと Size というフィールドが組み合わされます。  
  
8.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
     グループが定義されました。 次に、表示するフィールドをマトリックスの Tablix 本体領域にドラッグします。 手順 7. でグループ化するように選択したフィールドを、Tablix 本体領域のそれぞれの列に追加します。  
  
     このシナリオの場合、Tablix 行グループ領域の最初の列は不要です。 列を削除するには、列見出しを右クリックして、 **[列の削除]** をクリックします。 新しいダイアログ ボックスが開き、列に関連付けられているグループを削除するかどうかを確認するメッセージが表示されます。 **[いいえ]** をクリックします。 行グループ領域が削除され、Tablix 本体領域のみが残ります。  
  
     次に、既定の列のグループを削除します。  
  
9. 列グループ ペインで、既定の列グループを右クリックし、 **[グループの削除]** をクリックします。 新しいダイアログ ボックスが開き、グループとそれに関連した行および列を削除するか、グループのみを削除するかを確認するメッセージが表示されます。 **[グループのみを削除]** をクリックします。 列グループが削除され、列グループ領域が削除されます。 Tablix 本体領域のみが残ります。  
  
     次に、マトリックス全体にまたがるテキスト ボックスに対話的な並べ替えボタンを追加します。  
  
10. 最初の行のテキスト ボックス内をクリックして、 **[テキスト ボックスのプロパティ]** をクリックします。  
  
11. **[対話的な並べ替え]** をクリックします。  
  
12. **[このテキスト ボックスでの対話的な並べ替えを有効にする]** を選択します。  
  
13. **[並べ替えの対象の選択]** で、 **[グループ]** をクリックします。  
  
14. ドロップダウン リストから、手順 5. で作成したグループの名前を選択します。 グループ式が **[並べ替え]** ボックスに自動的にコピーされます。  
  
15. [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
     並べ替えボタンがテキスト ボックスに追加されました。  
  
16. (省略可) グループ値を表示する列では、重複値を非表示にできます。 レポート デザイン画面で、繰り返し値を非表示にするテキスト ボックスをクリックします。 プロパティ ペインで、 **[HideDuplicates]** までスクロールして、このマトリックスに関連付けられたデータセットの名前をドロップダウン リストから選択します。  
  
 並べ替えアクションを確認するには、 **[実行]** をクリックしてレポートをプレビューし、対話的な並べ替えボタンをクリックします。 グループ式の値の組み合わせによってマトリックスが並べ替えられます。ただし、個々の値はそれぞれの列に表示されます。  
  
 ![[トップに戻る] リンクで使用される矢印アイコン](../../2014-toc/media/uparrow16x16.gif "[トップに戻る] リンクで使用される矢印アイコン") [トップに戻る](#BackToTop)  
  
##  <a name="SynchronizingSortOrder"></a> 複数のデータ領域の並べ替え順序の同期  
 ユーザーが 1 つの並べ替えボタンをクリックすることによって、複数のデータ領域を並べ替えられるようにする、対話的な並べ替えボタンを追加します。 対話的な並べ替えボタンを作成する場合は、複数のデータ領域の並べ替えを同じレポート データセットに基づいて同期するかどうかを指定できます。 たとえば、マトリックスおよびデータをグラフィカルに表示するグラフが含まれたレポートがあるとします。 ユーザーがこのマトリックス内の行の並べ替え順序を変更すると、それと同じ並べ替え順序がグラフに自動的に表示されます。  
  
 並べ替え順序を同期するには、並べ替えるデータ領域またはグループに同一の並べ替え式を使用し、並べ替えの範囲が両方のデータ領域に共通の先祖になるように定義する必要があります。 共通の先祖は、両方のデータ領域が関連付けられているデータセットになる場合も、両方のデータ領域を内部に表示するデータ領域になる場合もあります。 たとえば、同じデータセットからのデータを表示し、同じ一覧に含まれているマトリックスとグラフが両方ともレポートに含まれているとします。 並べ替えアクションを同期するには、マトリックス内の列の 1 つで対話的な並べ替えを指定し、並べ替えの範囲を一覧に設定する必要があります。 ユーザーがこのマトリックスを並べ替えると、グラフも並べ替えられます。  
  
#### <a name="to-synchronize-sort-order-with-a-chart-for-an-interactive-sort-button-on-a-matrix-data-region"></a>マトリックス データ領域上の対話的な並べ替えボタンによる並べ替え順序をグラフと同期するには  
  
1.  レポート デザイン ビューで、レポートにマトリックスを追加します。  
  
2.  数量や売上を表すフィールドなど、数値形式のデータセット フィールドをマトリックスのデータ セルに追加します。  
  
3.  行グループを定義します。 既定で、グループの並べ替え順序は、グループ式と同じ式に設定されます。  
  
4.  円グラフなどのグラフをレポートに追加します。  
  
5.  手順 2. で選択したフィールドを **グラフ データ** ペインの **[値]** 領域にドラッグします。  
  
6.  グループ化するように選択したフィールドを **[カテゴリ グループ]** 領域にドラッグします。  
  
     マトリックス行グループとグラフ カテゴリ グループのグループ式は同一でなければなりません。  
  
7.  カテゴリ グループを右クリックして、 **[カテゴリ グループのプロパティ]** をクリックします。  
  
8.  **[並べ替え]** をクリックします。  
  
9. **[追加]** をクリックします。 新しい並べ替え行が、並べ替えオプションのグリッドに追加されます。  
  
10. [並べ替え] ボックスの一覧から、手順 6. でグループ化するように選択したフィールドを選択します。  
  
11. [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
12. マトリックスで、対話的な並べ替えボタンを追加する列見出しにあるテキスト ボックスを右クリックして、 **[テキスト ボックスのプロパティ]** をクリックします。  
  
13. **[対話的な並べ替え]** をクリックします。  
  
14. **[このテキスト ボックスでの対話的な並べ替えを有効にする]** を選択します。  
  
15. **[並べ替えの対象の選択]** で、 **[グループ]** をクリックします。  
  
16. **[グループ]** ボックスの一覧から、並べ替えるグループの名前を選択します。 このグループのグループ式が **[並べ替え]** の値に自動的に設定されます。  
  
17. **[この並べ替えを次の内部にある他のグループやデータ領域にも適用する]** を選択します。 テキスト ボックスに、"SalesData" などのデータセットの名前を入力します。  
  
18. [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
 並べ替えアクションを確認するには、 **[実行]** をクリックしてレポートをプレビューし、対話的な並べ替えボタンをクリックします。 グループ式の値の組み合わせによってマトリックスが並べ替えられます。ただし、個々の値はそれぞれの列に表示されます。  
  
 ![[トップに戻る] リンクで使用される矢印アイコン](../../2014-toc/media/uparrow16x16.gif "[トップに戻る] リンクで使用される矢印アイコン") [トップに戻る](#BackToTop)  
  
## <a name="see-also"></a>参照  
 [データのフィルター、グループ化、および並べ替え (レポート ビルダーおよび SSRS)](filter-group-and-sort-data-report-builder-and-ssrs.md)   
 [対話的な並べ替え &#40;レポート ビルダーおよび SSRS&#41;](interactive-sort-report-builder-and-ssrs.md)   
 [データ領域内のデータの並べ替え (レポート ビルダーおよび SSRS)](sort-data-in-a-data-region-report-builder-and-ssrs.md)   
 [Tablix データ領域の柔軟性について &#40;レポート ビルダーおよび SSRS&#41;](exploring-the-flexibility-of-a-tablix-data-region-report-builder-and-ssrs.md)  
  
  
