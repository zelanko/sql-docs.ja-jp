---
title: PowerPivot データ更新用の保存された資格情報の構成 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 23f35c8998b204182f25f85f8f7694fb60d042b4
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2020
ms.locfileid: "66087459"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a>PowerPivot データ更新用の保存された資格情報の構成 (PowerPivot for SharePoint)
  使用する資格情報を保存するために、対象アプリケーションを Secure Store Service で作成してあれば、PowerPivot データ更新ジョブは任意の Windows ユーザー アカウントで実行できます。 同様に、PowerPivot for Excel のデータを最初にインポートするときに使用するものとは異なるデータベース ログインを提供する場合は、その資格情報を Secure Store Service の対象アプリケーションにマップし、データ更新スケジュールでその対象アプリケーションを指定できます。  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010  
  
 このトピックの手順に従うと、PowerPivot データ更新スケジュール ページで次の資格情報オプションを使用できるようになります。  
  
 ![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")  
  
 このトピックでは、SharePoint 2010 ファーム内の PowerPivot データの更新操作に使用するユーザー名とパスワードの設定方法について説明します。 この手順を使用するには、あらかじめ、Secure Store Service を有効にし、マスター キーを生成しておく必要があります。 詳細については、「 [SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)」を参照してください。  
  
 このトピックには、次のセクションが含まれます。  
  
 [データ更新用の Windows アカウントの構成](#configAny)  
  
 [外部やサードパーティのデータ ソースにアクセスするための定義済みアカウントの構成](#config3rd)  
  
 データ更新の構成または使用に関する問題が発生した場合は、TechNet wiki の「 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/?LinkID=223279)」ページを参照してください。  
  
##  <a name="configAny"></a>データ更新用の Windows アカウントを構成する  
 SharePoint ユーザーがデータ更新スケジュールを定義するときには、データ更新の実行に使用するユーザー ID を指定する必要があります。 オプションとしては、PowerPivot 自動データ更新アカウントを選択する方法、ユーザー自身の Windows ドメイン ユーザー アカウントを入力する方法、またはデータ更新の目的に使用できるその他の Windows ユーザー アカウントを入力する方法があります。 ここでは、最後のオプション (その他の Windows アカウントを指定する方法) の手順を示します。  
  
 この方法は、PowerPivot 自動データ更新アカウント (SharePoint 上のすべての PowerPivot ユーザーが利用可能) の使用またはブック所有者の資格情報の使用に代わる方法が必要な場合に選択できます。 たとえば、組織レベルでのデータ更新操作の追跡および管理が容易になるように、ワークグループに応じて一連のデータ更新アカウントを利用可能にすることが必要になる場合があります。  
  
> [!IMPORTANT]  
>  この対象アプリケーション (および保存される資格情報) を使用するユーザーとアプリケーションは、アプリケーションのメンバーとして表示される必要があります。 また、対象アプリケーション、Windows アカウント、およびデータ更新スケジュールでこの対象アプリケーションを指定するユーザーのグループやユーザー アカウントを使用する、PowerPivot サービス アプリケーションの各 ID を追加する必要があります。 これらのアカウントは、対象アプリケーションを作成するときにすべて指定できます。 このアプリケーションにアクセスする必要があるユーザー アカウントとグループ アカウントがわからない場合は、対象アプリケーションを作成した後で追加できます。  
  
 データ更新用の保存された資格情報の構成には次の 4 つの部分があります。  
  
-   資格情報を保存する対象アプリケーションを作成する。  
  
-   アカウントに投稿権限を付与する。  
  
-   データ更新中に外部データ ソースにアクセスするための読み取り権限をアカウントに付与する。  
  
-   この対象アプリケーションをデータ更新スケジュールで指定した場合にデータ更新が動作することを確認する。  
  
### <a name="step-1-create-a-target-application"></a>手順 1: 対象アプリケーションを作成する  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  [ **Secure Store Service**] をクリックします。  
  
3.  [ターゲットアプリケーションの管理] で、[**新規**] をクリックします。  
  
4.  [対象アプリケーション ID] に、テキスト文字列を入力します。 文字列は一意であることが必要ですが、覚えやすい文字列を指定してください。 ユーザーがこのアプリケーションに保存された資格情報を使用する場合は、データ更新スケジュール ページでこの文字列を入力します。  
  
5.  [表示名] に、わかりやすい名前を入力します。 この名前は表示にのみ使用されます。 データ更新スケジュールで対象アプリケーションを指定する場合には使用されません。  
  
6.  [連絡先の電子メール] に、自分の電子メール アドレスを入力します。  
  
7.  [ターゲットアプリケーションの種類] で、[**グループ**] を選択します。  
  
    > [!IMPORTANT]  
    >  [グループ] アカウントの種類を選択すると、資格情報へのアクセスを要求するすべてのユーザーおよびサービス アカウントを指定できるため、このアカウントの種類を選択する必要があります。 要求ごとに、PowerPivot System サービスは要求元が対象アプリケーションのメンバーかどうかを確認します。  
  
8.  [対象アプリケーションのページ URL] はスキップします。 PowerPivot データ更新では使用されません。  
  
9. **[次へ]** をクリックします。  
  
10. [ **Secure Store のターゲットアプリケーションの資格情報フィールドの指定**] ページで、既定値をそのまま使用します。 フィールドの名前と種類は、Windows ユーザー名と Windows パスワードにする必要があります。  
  
11. [次へ] をクリックします。  
  
12. [ターゲット アプリケーションの管理者] で、ターゲット アプリケーション設定に対する管理アクセス権 (たとえば、[メンバー] ボックスの一覧でアカウントを追加または削除する機能) を必要とする SharePoint ユーザーの Windows ドメイン ユーザー アカウントを指定します。  
  
13. [メンバー] で、次のユーザー アカウントとグループ アカウントを追加します。  
  
    1.  アプリケーションの作成者として、自分の Windows ユーザー アカウントを [メンバー] ボックスの一覧に追加します。  
  
    2.  スケジュールによってデータ更新が実行されるときに資格情報を取得できるように、PowerPivot サービス アプリケーションのアプリケーション プール ID を追加します。 アプリケーションプール id を表示するには、[**サービスアプリケーションの管理**] にアクセスし、名前の横にある空白部分をクリックして PowerPivot サービスアプリケーションを選択します (これにより行が選択されます)。次に、[**プロパティ**] をクリックします。 このページに表示されるセキュリティ アカウントが、対象アプリケーションのメンバーとして追加するアカウントになります。  
  
    3.  データ更新スケジュールにこの対象アプリケーションを登録する Windows ユーザー アカウントとグループ アカウントを追加します。  
  
14. **[OK]** をクリックします。  
  
15. 先ほど作成したターゲットアプリケーションを選択し、下矢印をクリックして、[**資格情報の設定**] を選択します。  
  
16. [資格情報の所有者] の資格情報の所有者の一覧は読み取り専用です。 資格情報の所有権を持つアカウントは、対象アプリケーションのメンバーです。 資格情報の所有者を追加または削除するには、対象アプリケーションのメンバーの一覧でアカウントを追加または削除する必要があります。  
  
     [Windows ユーザー名] および [Windows パスワード] に、データ更新の実行に使用する Windows ユーザー アカウントの資格情報を入力します。  
  
17. **[OK]** をクリックします。  
  
###  <a name="bkmk_grant"></a>手順 2: アカウントに投稿権限を付与する  
 保存された資格情報を使用する前に、使用するすべての PowerPivot ブックで、このアカウントに投稿権限を割り当てる必要があります。 この権限レベルは、ライブラリからブックを開き、データの更新後に再度ライブラリに保存するために必要です。  
  
 権限の割り当ては、サイト コレクションの管理者が実行する手順です。 SharePoint の権限は、ルート サイト コレクションで割り当てるか、ルート サイト コレクションより下位の任意のレベル (個々のドキュメントやアイテムを含む) で割り当てることができます。 権限の設定方法は、権限をどのくらい細かく設定する必要があるかによって異なります。 次の手順は、権限を付与する方法の一例を示しています。  
  
1.  SharePoint サイトで、[サイトの操作] の [**サイトの権限**] をクリックします。  
  
2.  
  **[アクセス許可の付与]** をクリックします。  
  
3.  [ユーザーの選択] に、対象アプリケーションで指定した Windows ドメイン ユーザー アカウントの名前を入力します。  
  
4.  [アクセス許可の付与] で、[**ユーザーにアクセス許可を直接付与**する] を選択します。  
  
5.  [**投稿**] を選択し、[ **OK**] をクリックします。  
  
###  <a name="bkmk_dbread"></a>手順 3: データ更新で使用される外部データソースにアクセスするための読み取り権限を付与する  
 データを PowerPivot ブックにインポートする場合、通常、外部データへの接続は、信頼関係接続か、(現在のユーザーの ID を使用してデータ ソースに接続する) 権限を借用した接続に基づきます。 これらの種類の接続は、現在のユーザーがインポートする対象のデータに対する読み取り権限を持つ場合にのみ有効です。  
  
 データ更新シナリオでは、データをインポートするために使用された接続文字列が、データを更新するために再利用されます。 接続文字列が現在のユーザーを想定している (たとえば、Integrated_Security=SSPI を含む文字列) 場合、PowerPivot System サービスは、対象アプリケーションで指定したユーザー ID を現在のユーザーとして渡します。 この接続は、外部データ ソースに対する読み取り権限がアカウントに付与されている場合にのみ成功します。  
  
 このため、アカウントには、データ更新中に使用されるすべての外部データ ソースに対する読み取り専用権限を付与する必要があります。  
  
 組織で使用しているデータ ソースの管理者であれば、ログインを作成し、必要な権限を付与することができます。 管理者でない場合は、データの所有者に対してアカウント情報を連絡する必要があります。 対象アプリケーションにマップされる Windows ドメイン ユーザー アカウントを必ず指定してください。 これは、このトピックの「手順 1: ターゲットアプリケーションを作成する」で指定したアカウントです。  
  
###  <a name="bkmk_verify"></a>手順 4: データ更新構成ページでアカウントの可用性を確認する  
  
1.  PowerPivot データが含まれているパブリッシュ済みのブックのデータ更新構成ページを開きます。 ページを開く方法については、「 [PowerPivot for SharePoint&#41;&#40;データ更新をスケジュールする](schedule-a-data-refresh-powerpivot-for-sharepoint.md)」を参照してください。  
  
2.  [データ更新の構成] ページで [ **Secure Store Service (SSS) に保存された資格情報を使用してデータソースにログオン**します] オプションが有効になっていることを確認し、ターゲットアプリケーションの名前を入力します。  
  
3.  [**直ちに更新**する] チェックボックスをオンにし、[ **OK**] をクリックします。  
  
4.  ブックが格納されているライブラリで、ブックを選択し、右側に表示される下矢印をクリックして、[ **PowerPivot データ更新の管理**] を選択します。 データ更新ジョブが返すデータ量が多い場合は、数分待つことが必要な場合があります。  
  
 エラーが発生した場合は、[データ更新の履歴] ページで [**スケジュールの構成**] をクリックして、別の資格情報を試すことができます。 元のブックのデータ ソース接続情報を調べて、データ更新時に使用される接続文字列を表示することが必要な場合もあります。 接続文字列は、問題のトラブルシューティングに使用できるサーバーの場所とデータベースに関する情報を提供します。  
  
 トラブルシューティングの詳細については、TechNet Wiki の「 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/p/?LinkID=223279)」を参照してください。  
  
##  <a name="config3rd"></a>外部またはサードパーティのデータソースにアクセスするための定義済みアカウントの構成  
 多くの場合、データベース サーバーには独自の認証方法が用意されています。 データ更新時に外部データ ソースへアクセスするためにデータベース資格情報を必要とする PowerPivot ブックがある場合は、資格情報の対象アプリケーション ID を作成し、[データ更新のスケジュール] ページの [データ ソース] セクションで、対象アプリケーションを指定できます。  
  
 この手順は、PowerPivot ブックに既に埋め込まれているデータベース資格情報をオーバーライドするオプションをユーザーに提供する場合にのみ必要です。  
  
 この手順は、接続文字列にユーザー名とパスワードが既に含まれている場合にのみ有効です。 接続文字列に資格情報があることは比較的少ないため、このオプションを利用する機能はある程度制限されています。 データベース認証を使用してデータ ソースに接続する場合は、接続文字列にユーザー ID とパスワードだけを使用するのが一般的です。 接続文字列にユーザー ID とパスワードが含まれているかどうかを確認する方法の詳細については、「 [SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)」の「スケジュールを作成し、外部データにアクセスするためのアクセス許可を付与する」を参照してください。  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  [ **Secure Store Service**] をクリックします。  
  
3.  [ターゲットアプリケーションの管理] で、[**新規**] をクリックします。  
  
4.  [対象アプリケーション ID] に、テキスト文字列を入力します。 文字列は一意であることが必要ですが、覚えやすい文字列を指定してください。 ユーザーがこのアプリケーションに保存された資格情報を使用する場合は、データ更新スケジュール ページでこの文字列を入力します。  
  
5.  [表示名] に、わかりやすい名前を入力します。 この名前は表示にのみ使用されます。 データ更新スケジュールで対象アプリケーションを指定する場合には使用されません。  
  
6.  [連絡先の電子メール] に、自分の電子メール アドレスを入力します。  
  
7.  [ターゲットアプリケーションの種類] で、[**グループ**] を選択します。  
  
8.  [対象アプリケーションのページ URL] はスキップします。 PowerPivot データ更新では使用されません。  
  
9. **[次へ]** をクリックします。  
  
10. [ **Secure Store のターゲットアプリケーションの資格情報フィールドの指定**] ページで、データソースが Windows 認証を使用している場合に限り、既定値をそのまま使用します。 それ以外の場合は、データ ソースに対して有効なフィールドの種類を選択し、その種類に合わせてフィールド名を編集します。  
  
     たとえば、フィールド名に SQL Server ユーザー名と SQL Server ユーザー パスワードを指定し、フィールドの種類に [ユーザー名] と [パスワード] を選択できます。  
  
11. [次へ] をクリックします。  
  
12. [対象アプリケーションの管理者] で、アプリケーション設定に対する管理アクセス権を必要とする SharePoint ユーザーの Windows ドメイン ユーザー アカウントを指定します。  
  
13. [メンバー] で、次のユーザー アカウントとグループ アカウントを追加します。  
  
    1.  アプリケーションの作成者として、自分の Windows ユーザー アカウントを [メンバー] ボックスの一覧に追加します。  
  
    2.  保存した資格情報にアクセスするために対象アプリケーションを使用する各 PowerPivot サービス アプリケーションのアプリケーション プール ID を追加します。 Id を表示するには、[**サービスアプリケーションの管理**] にアクセスし、名前の横にある空白部分をクリックして PowerPivot サービスアプリケーションを選択し (これにより行が選択されます)、[**プロパティ**] をクリックします。 このページに表示されるセキュリティアカウントは、対象アプリケーションのメンバーとして追加するアカウントです。  
  
    3.  データ更新スケジュール ページのデータ ソース セクションにこの対象アプリケーションを登録する Windows ユーザー アカウントとグループ アカウントを追加します。  
  
14. **[OK]** をクリックします。  
  
15. 先ほど作成したターゲットアプリケーションを選択し、下矢印をクリックして、[**資格情報の設定**] を選択します。  
  
16. データ ソースへの接続に使用される資格情報 (たとえば、SQL Server ログインのユーザー名とパスワード) を入力します。  
  
17. **[OK]** をクリックします。  
  
## <a name="see-also"></a>参照  
 [データ更新 &#40;PowerPivot for SharePoint をスケジュールする&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)   
 [SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
