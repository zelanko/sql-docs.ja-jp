---
title: Parallel Data Warehouse のステージング データベースを使用する |Microsoft Docs
description: SQL Server 並列データ ウェアハウス (PDW) では、ステージング データベースを使用して、読み込みプロセス中に一時的にデータを格納します。
author: mzaman1
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 824ad4dedee0224023f50b6855b2de1e53581304
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "67960032"
---
# <a name="using-a-staging-database-in-parallel-data-warehouse-pdw"></a>並列データ ウェアハウス (PDW) で、ステージング データベースを使用します。
SQL Server 並列データ ウェアハウス (PDW) では、ステージング データベースを使用して、読み込みプロセス中に一時的にデータを格納します。 既定では、SQL Server PDW は、テーブルの断片化が発生することができます、ステージング データベースと転送先データベースを使用します。 テーブルの断片化を減らすためには、ユーザー定義のステージング データベースを作成することができます。 または、読み込みエラーからのロールバックが問題ではないときに、一時テーブルをスキップして、変換先テーブルに直接読み込むパフォーマンスを向上させるために、fastappend 読み込みモードを使用することができます。  
  
## <a name="StagingDatabase"></a>ステージング データベースの基本  
A*ステージング データベース*はアプライアンスへの読み込み中に一時的にデータを格納、ユーザーが作成した PDW データベースです。 読み込み、ステージング データベースを指定すると、アプライアンスは、ステージング データベースにデータをコピーしたとステージング データベースの一時テーブルからコピー先データベースに永続的なテーブルにデータをコピーします。  
  
読み込み、ステージング データベースが指定されていない SQL ServerPDW は転送先データベースに一時テーブルを作成しを使用して、読み込まれたデータを永続的なレプリケーション先テーブルに挿入する前に、読み込まれたデータを格納します。  
  
負荷を使用している場合、 *fastappend モード*、SQL ServerPDW は一時テーブルを完全に使用をスキップし、対象のテーブルに直接データを追加します。 Fastappend モードでは、データは、アプリケーションの観点から一時テーブルであるテーブルを読み込む ELT シナリオの読み込みのパフォーマンスが向上します。 たとえば、ELT プロセスでした一時テーブルにデータを読み込む、クレンジングし、この除外が行われる解除してデータを処理およびファクト テーブルにデータを挿入します。 この場合、必要はありません PDW の最初の読み込みを内部の一時テーブルにデータをアプリケーションの一時テーブルにデータを挿入する前にします。 Fastappend モードでは、読み込みのパフォーマンスが大幅に向上余分な負荷の手順を回避します。 Fastappend モードを使用するには、読み込みプロセスによって中止されたかどうかの負荷からの復旧を処理する必要がありますが、複数のトランザクション モードを使用する必要があります。  
  
**ステージング データベースの利点があります。**  
  
ステージング データベースの主なメリットは、テーブルの断片化を低減します。 ステージング データベースを使用しない場合は、転送先データベース内の一時テーブルにデータが読み込まれます。 一時テーブルを取得作成され、転送先データベースを削除すると、一時テーブルと永続的なテーブルのページはインターリーブになります。 時間の経過と共にテーブルの断片化が発生し、パフォーマンスが低下します。 これに対し、ステージング データベースは、一時テーブルが作成され、永続的なテーブルよりも、別のファイル領域で削除するようにします。  
  
**ステージング データベース テーブルの構造**  
  
各データベース テーブルのストレージ構造は、変換先テーブルによって異なります。  
  
-   ヒープまたはクラスター化列ストア インデックスに読み込まれ、ステージング テーブルはヒープです。  
  
-   行ストア クラスター化インデックスに読み込まれ、ステージング テーブルは行ストア クラスター化インデックスです。  
  
## <a name="Permissions"></a>アクセス許可  
ステージング データベース (一時テーブルの作成) に対する作成アクセス許可が必要です。 

<!-- MISSING LINKS

For more information, see [Grant Permissions to load data](grant-permissions-to-load-data.md).  

-->
  
## <a name="CreatingStagingDatabase"></a>ステージング データベースを作成するためのベスト プラクティス  
  
1.  アプライアンスごとに 1 つのステージング データベースのみあります。 すべてのコピー先データベースのすべてのジョブの読み込みでは、ステージング データベースを共有できます。  
  
2.  ステージング データベースのサイズは、お客様ごとに固有です。 最初に、アプライアンスをまず設定するには、するときに、ステージング データベースは、初期読み込みジョブに対応するために十分な大きさのようになります。 これらのジョブのロードを複数の負荷は同時に実行されるために大きくなる傾向があります。 初期読み込みのジョブが完了すると、システムが実稼働環境では、各読み込みジョブのサイズが小さくなる可能性があります。 負荷が小さいときは、比較的小さなサイズの負荷に対応するステージング データベースのサイズを小さくことができます。 サイズを減らすためには、ステージング データベースを削除し、小さいサイズの割り当てを使用してもう一度作成または使用することができます、 [ALTER DATABASE](../t-sql/statements/alter-database-transact-sql.md?tabs=sqlpdw)ステートメント。  
  
    ステージング データベースを作成する場合は、次のガイドラインを使用します。  
  
    -   レプリケートされたテーブルのサイズは同時に読み込むすべてのレプリケートされたテーブルのコンピューティング ノードあたりの推定サイズがあります。 サイズは、通常は 25 ~ 30 GB です。  
  
    -   分散テーブルのサイズは同時に読み込むすべての分散テーブルのアプライアンスごとの推定サイズがあります。  
  
    -   ログのサイズは、通常、レプリケートされたテーブルのサイズに似ています。  
  
## <a name="Examples"></a>例  
  
### <a name="a-create-a-staging-database"></a>A. ステージング データベースを作成します。 
次の例では、ステージング データベース、Stagedb、アプライアンス上のすべての負荷で使用するため作成します。 レプリケートされたテーブルのサイズが 5 つの見積もりとあたり 5 GB が同時に読み込まれます。 この同時実行により、レプリケートされたサイズの少なくとも 25 GB を割り当てます。 6 つの分散サイズ 100 のテーブルであることを推定すると、200、400、500、500、および 550 GB は同時に読み込まれます。 この同時実行により、分散テーブルのサイズの少なくとも 2250 GB を割り当てます。  
  
```sql  
CREATE DATABASE Stagedb  
WITH (  
  
    AUTOGROW = ON,  
  
    REPLICATED_SIZE = 25 GB,  
  
    DISTRIBUTED_SIZE = 2250 GB,  
  
    LOG_SIZE = 25 GB  
  
);  
```  

<!-- MISSING LINKS
 
## See Also  
[Common metadata query examples](metadata-query-examples.md)  

-->
  
