---
title: データベース コピー ウィザードの使用 | Microsoft Docs
ms.custom: ''
ms.date: 07/26/2016
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- sql13.swb.cdw.packageconfiguration.f1
- sql13.swb.cdw.schedule.f1
- sql13.swb.cdw.transfermethod.f1
- sql13.swb.cdw.databases.f1
- sql13.swb.cdw.destinationconfiguration.f1
- sql13.swb.cdw.destination.f1
- sql13.swb.cdw.locationofsourcedbfiles.f1
- sql13.swb.cdw.source.f1
- sql13.swb.cdw.selectdatabaseobjects.f1
- sql13.swb.cdw.complete.f1
- sql13.swb.cdw.welcome.f1
helpviewer_keywords:
- Copy Database Wizard
- starting Copy Database Wizard
ms.assetid: 7a999fc7-0a26-4a0d-9eeb-db6fc794f3cb
author: stevestein
ms.author: sstein
ms.openlocfilehash: 67488a92a14a2533c9ba6ef14941b11b8bcbb8c2
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68127116"
---
# <a name="use-the-copy-database-wizard"></a>データベース コピー ウィザードの使用
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
データベース コピー ウィザードを使用すると、特定のサーバー オブジェクトを [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]  のあるインスタンスから別のインスタンスに、簡単に移動またはコピーできます。サーバーのダウンタイムが生じることはありません。 このウィザードを使用すると、次の操作を実行できます。 
  
-   移動元またはコピー元、および移動先またはコピー先サーバーを選択します。  
  
-   移動、またはコピーするデータベース (複数可) を選択します。  
  
-   データベースのファイルの場所を指定します。  
  
-   移動先またはコピー先サーバーにログインをコピーします。  
  
-   追加のサポート オブジェクト、ジョブ、ユーザー定義のストアド プロシージャ、およびエラー メッセージをコピーします。  
  
-   データベースを移動またはコピーする時期をスケジュールします。  
  

##  <a name="Restrictions"></a> 制限事項と制約事項  
  
-   データベース コピー ウィザードは、Express Edition では使用できません。  
  
-   データベース コピー ウィザードを使用して、次のデータベースをコピーしたり移動したりすることはできません。
  
    -   システムのデータベース
  
    -   レプリケーション用にマーク付けされているデータベース
  
    -   アクセス不可、読み込み中、オフライン、復旧中、未確認、または緊急モードのマーク付けがされているデータベース
    
    -   データまたはログ ファイルを Microsoft Azure Storage に保存しているデータベース
  
-   [FileTables](../../relational-databases/blob/filetables-sql-server.md) を使用するとき、同じサーバーでデータベース コピー ウィザードを使用することはできません。このウィザードでは同じディレクトリ名が使用されるためです。

-   データベースは、SQL Server の以前のバージョンに移動またはコピーすることはできません。
  
-   **[移動]** オプションを選択した場合、データベースを移動した後で、コピー元データベースが自動的に削除されます。 **[コピー]** オプションを選択した場合は、コピー元データベースが削除されません。  さらに、選択したサーバー オブジェクトは、移動ではなくコピーされます。実際に移動されるオブジェクトはデータベースだけです。
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理オブジェクトの方法を使用してフルテキスト カタログを移動する場合は、移動後にインデックスを再作成する必要があります。  
  
-   **デタッチ後にアタッチ** する方法では、データベースをデタッチして、データベースの .mdf、.ndf、.ldf ファイルを移動するかコピーして、新しい場所でデータベースをもう一度アタッチします。 **デタッチ後にアタッチ** する方法では、データの損失や不整合を避けるため、移動またはコピーするデータベースにアクティブなセッションをアタッチすることはできません。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理オブジェクトの方法では、データベースがオフラインになることがないため、アクティブなセッションが許可されています。  

-    移動先またはコピー先サーバーにまだ存在しないデータベースを参照する SQL Server エージェント ジョブを転送すると、操作全体の失敗につながります。  ウィザードは、データベースを作成する前に、SQL Server エージェント ジョブの作成を試行します。  以下の回避策があります。
     1. 移動先またはコピー先サーバーに、コピーまたは移動するデータベースと同じ名前を持つシェル データベースを作成します。  「 [データベースの作成](../../relational-databases/databases/create-a-database.md)」を参照してください。
     
     2. **[転送先データベースの構成]** ページで、 **[転送先サーバーに存在する同じ名前のすべてのデータベースを削除して、データベースの転送を続行し、既存のデータベース ファイルを上書きする]** を選択します。

> **重要!!** **デタッチ後にアタッチ** する方法を使用すると、転送元と転送先のデータベースの所有権が、 **データベース コピー ウィザード**を実行しているログインに設定されます。  データベースの所有権を変更するには、「 [ALTER AUTHORIZATION (Transact-SQL)](../../t-sql/statements/alter-authorization-transact-sql.md) 」を参照してください。
  
  
##  <a name="Prerequisites"></a> 前提条件  
-   移動先またはコピー先のサーバーで SQL Server エージェントが起動されていることを確認します。  

-   移動元またはコピー元のサーバー上のデータとログ ファイル ディレクトリに、移動先またはコピー先サーバーから到達できることを確認します。

-   **デタッチ後にアタッチ** する方法では、SSIS サブシステムの SQL Server エージェント プロキシが、移動元と移動先の両方のサーバーのファイル システムにアクセスできる資格情報を持つ移動先サーバー上に存在している必要があります。 プロキシの詳細については、「 [SQL Server エージェント プロキシの作成](~/ssms/agent/create-a-sql-server-agent-proxy.md)」を参照してください。

> **重要!!** **デタッチ後にアタッチ** する方法では、Integration Services プロキシ アカウントを使用しないと、コピーまたは移動プロセスが失敗します。  特定の状況下では、ソース データベースはコピー元または移動元サーバーに再アタッチされず、すべての NTFS セキュリティ アクセス許可がデータとログ ファイルから除去されます。  このような場合は、ファイルに移動し、関連する権限を再適用した後、データベースを SQL Server のインスタンスに再アタッチします。
  
##  <a name="Recommendations"></a> 推奨事項  
  
-   アップグレードしたデータベースのパフォーマンスを最適化するには、アップグレードしたデータベースに対して [sp_updatestats (Transact-SQL)](../../relational-databases/system-stored-procedures/sp-updatestats-transact-sql.md) (統計の更新) を実行します。  
  
-   データベースを別のサーバー インスタンスに移動またはコピーするときは、ユーザーおよびアプリケーションに一貫した使用環境を提供するために、アタッチ先のサーバー インスタンスで、ログインやジョブなどのデータベースのメタデータの一部またはすべてを作成し直す必要が生じる場合があります。 詳細については、「 [データベースを別のサーバー インスタンスで使用できるようにするときのメタデータの管理 &#40;SQL Server&#41;](../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md)」を参照してください。  
  

  
###  <a name="Permissions"></a> Permissions  
 コピー元または移動元とコピー先または移動先の両方のサーバーにおいて **sysadmin** 固定サーバー ロールのメンバーである必要があります。  
  
##  <a name="Overview"></a> データベース コピー ウィザードのページ 
SQL Server Management Studio で **オブジェクト エクスプローラー** から **データベース コピー ウィザード** を起動し、 **[データベース]** を展開します。  次に、データベースを右クリックして、 **[タスク]** をポイントし、 **[データベースのコピー]** をクリックします。  **[データベース コピー ウィザードへようこそ]** のスプラッシュ ページが表示されたら、 **[次へ]** をクリックします。


### <a name="select-a-source-server"></a>転送元サーバーの選択
移動またはコピーするデータベースがあるサーバーの指定や、ログイン情報の入力を行います。  認証方法を選択し、ログイン情報を入力したら、 **[次へ]** をクリックして転送元サーバーとの接続を確立します。  セッションの間、この接続は開いています。

-    **[転送元サーバー]**  
移動またはコピーするデータベースが配置されているサーバーの名前を識別します。  手動で入力するか、省略記号をクリックして目的のサーバーに移動します。  サーバーは、SQL Server 2005 以上である必要があります。

-    **[Windows 認証を使用する]**  
Microsoft Windows ユーザー アカウントを使用して接続することをユーザーに許可します。

-    **[SQL Server 認証を使用する]**  
SQL Server 認証用のユーザー名とパスワードを入力して接続することをユーザーに許可します。

     -    **User name**  
接続に使用するユーザー名を入力します。 このオプションは、 **SQL Server 認証**を使用した接続を選択した場合にのみ使用できます。

     -    **パスワード**  
ログインのパスワードを入力します。 このオプションは、 **SQL Server 認証**を使用した接続を選択した場合にのみ使用できます。

###  <a name="select-a-destination-server"></a>転送先サーバーの選択
データベースの移動先またはコピー先のサーバーを指定します。  移動先またはコピー先のサーバーと、移動元またはコピー元のサーバーに同じサーバー インスタンスを設定した場合、データベースのコピーが作成されます。  この場合、後でウィザードでデータベースの名前を変更する必要があります。  コピー元または移動元データベースの名前をコピー先または移動先データベースの名前に使用できるのは、コピー先または移動先サーバーに名前の競合がない場合のみです。  名前が競合する場合、コピー元または移動元のデータベース名を使用する前にコピー先または移動先サーバーの競合を手動で解決する必要があります。
  
-    **[転送先サーバー]**  
移動またはコピーするデータベースが配置されているサーバーの名前を識別するために使用します。  手動で入力するか、省略記号をクリックして目的のサーバーに移動します。  サーバーは、SQL Server 2005 以上である必要があります。

     >**注:** 転送先またはコピー先のサーバーとして、クラスター化されたサーバーを使用できます。その場合、データベース コピー ウィザードは、そのクラスター化された転送先またはコピー先のサーバーの共有ドライブのみが選択されていることを確認します。

-    **[Windows 認証を使用する]**  
Microsoft Windows ユーザー アカウントを使用して接続することをユーザーに許可します。

-    **[SQL Server 認証を使用する]**  
SQL Server 認証用のユーザー名とパスワードを入力して接続することをユーザーに許可します。

     -    **User name**  
接続に使用するユーザー名を入力します。 このオプションは、 **SQL Server 認証**を使用した接続を選択した場合にのみ使用できます。

     -    **パスワード**  
ログインのパスワードを入力します。 このオプションは、 **SQL Server 認証**を使用した接続を選択した場合にのみ使用できます。

###  <a name="select-the-transfer-method"></a>転送方法の選択
 
-    **[デタッチ後にアタッチする方法を使用する]**  
コピー元サーバーのデータベースをデタッチし、データベース ファイル (.mdf、.ndf、.ldf) をコピー先サーバーにコピーした後、データベースをコピー先サーバーにアタッチします。 主な処理はコピー元ディスクを読み取り、コピー先ディスクに書き込むだけなので、通常は高速に処理されます。 データベース内にオブジェクトを作成したり、データ ストレージ構造体を作成したりするために必要な [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ロジックは不要です。 ただし、データベースに割り当て済みの未使用の領域が多量にある場合は、この方法では時間がかかる場合があります。 たとえば、100 MB の割り当てで新しく作成された事実上空のデータベースの場合、5 MB のみが使用されているだけでも、全 100 MB がコピーされます。

     > **注:** この方法の場合、転送中はユーザーがデータベースを使用できなくなります。

     -    **[失敗した場合にソース データベースを再アタッチする]**  
     データベースのコピー時には、元のデータベース ファイルが必ずコピー元サーバーに再アタッチされます。 データベースの移動を完了できない場合に元のファイルをソース データベースに再アタッチするには、このチェック ボックスをオンにします。 
  
-    **[SQL 管理オブジェクトの方法を使用する]**  
     コピー元データベースの各データベース オブジェクトの定義を読み取って、コピー先データベースに各オブジェクトを作成します。 その後、コピー元テーブルのデータをコピー先テーブルに転送し、インデックスとメタデータを再作成します。
  
     > [!NOTE]
     >  データベース ユーザーは転送中もデータベースにアクセスできます。 
  
###  <a name="select-database"></a>データベースの選択
移動元またはコピー元のサーバーから移動先またはコピー先のサーバーへ移動またはコピーする 1 つ以上のデータベースを選択します。  トピックの上部にある「 [制限事項と制約事項](#Restrictions) 」を参照してください。  
  
-    **[移動]**  
データベースが移動先サーバーに移動されます。

-    **[コピー]**  
データベースがコピー先サーバーにコピーされます。

-    **ソース**  
移動またはコピー元のサーバーに存在するデータベースが表示されます。

-    **ステータス**  
ソース データベースのさまざまな情報が表示されます。

-    **[更新]**  
データベースの一覧が更新されます。
  
### <a name="configure-destination-database"></a>[転送先データベースの構成]
適切な場合には、データベース名を変更して、データベース ファイルの場所と名前を指定します。  このページは、移動またはコピーするデータベースごとに一度表示されます。

-    **[移行元データベース]**  
ソース データベースの名前。  このテキスト ボックスは編集できません。

-    **[移行先データベース]**  
必要に応じて、作成される移動先またはコピー先のデータベースの名前を変更します。

-    **[転送先データベース ファイル]:**  
     
     -    **Filename**  
必要に応じて、作成される移動先またはコピー先のデータベース ファイルの名前を変更します。

     -    **[サイズ (MB)]**  
移動先またはコピー先のデータベース ファイルのサイズ (MB 単位)。

     -    **[同期先フォルダー]**  
必要に応じて、移動先またはコピー先のデータベース ファイルをホストする移動先またはコピー先のサーバーのフォルダーを変更します。

     -    **ステータス**  
状態

-    **移動先またはコピー先データベースが既に存在する場合:**  
     移動先またはコピー先データベースが既に存在する場合に行う操作を決定します。

     -    **[転送先に同じ名前のデータベースまたはファイルが存在する場合は、転送を中止する]**

     -    **[転送先サーバーに存在する同じ名前のすべてのデータベースを削除して、データベースの転送を続行し、既存のデータベース ファイルを上書きする]**

###  <a name="select-server-objects"></a>サーバー オブジェクトの選択 
このページは、移動元のサーバーと移動先のサーバーが異なる場合にのみ使用できます。  
  
-    **[使用可能な関連オブジェクト]**  
転送先のサーバーへの転送に使用できるオブジェクトを一覧表示します。  オブジェクトを操作の対象にするには、 **[使用可能な関連オブジェクト]** ボックスでオブジェクト名をクリックした後、 **>>** ボタンをクリックして **[選択した関連オブジェクト]** ボックスにオブジェクトを移動します。 

-    **[選択した関連オブジェクト]**  
転送先のサーバーに転送されるオブジェクトの一覧を表示します。  オブジェクトを操作の対象から除外するには、 **[選択した関連オブジェクト]** ボックスでオブジェクト名をクリックした後、 **<\<** ボタンをクリックして **[使用可能な関連オブジェクト]** ボックスにオブジェクトを移動します。  既定では、選択したそれぞれの種類のオブジェクトがすべて転送されます。 特定の種類のオブジェクトを個別に選択するには、 **[選択した関連オブジェクト]** ボックスの横にある参照ボタンをクリックします。  ここで開くダイアログ ボックスを使用して、オブジェクトを個別に選択できます。

-    **サーバー オブジェクトの一覧** 

      -    **[ログイン] (既定で選択)** 
  
     -    **SQL Server エージェント ジョブ**  
  
     -    **[ユーザー定義エラー メッセージ]**  
  
     -    **エンドポイント**  
  
     -    **フルテキスト カタログ** 
  
     -    **[SSIS パッケージ]**  
     
     -    **[master データベースからのストアド プロシージャ]** 
          >**注:** 拡張ストアド プロシージャおよび関連する DLL は、自動コピーの対象になりません。  
    
  
###   <a name="location-of-source-database-files"></a>転送元のデータベース ファイルの場所
このページは、移動元のサーバーと移動先のサーバーが異なる場合にのみ使用できます。  転送元サーバー上のデータベース ファイルが格納されているファイル システム共有を指定します。
  
-    **[データベース]**  
     移動される各データベースの名前を表示します。  
  
-    **[フォルダーの場所]**  
転送元サーバー上にあるデータベース ファイルのフォルダーの場所。
たとえば、 `C:\Program Files\Microsoft SQL Server\MSSQL110.MSSQLSERVER\MSSQL\DATA`のようにします。

  
-    **[転送元のサーバーでのファイル共有]**  
転送元サーバー上にあるデータベース ファイルを含むファイル共有。  手動で共有を入力するか、省略記号をクリックして共有に移動します。
たとえば、 `\\server_name\C$\Program Files\Microsoft SQL Server\MSSQL110.MSSQLSERVER\MSSQL\Data`のようにします。

### <a name="configure-the-package"></a>パッケージの構成
データベース コピー ウィザードでは、データベースを転送するための SSIS パッケージが作成されます。

-    **[パッケージの場所]**  
SSIS パッケージを書き込む場所が表示されます。

-    **パッケージ名**  
SSIS パッケージの既定の名前が作成されます。必要に応じて変更します。

-    **[ログ オプション]**  
ログ情報を Windows イベント ログとして保存するか、テキスト ファイルとして保存するかを選択します。

-    **[エラー ログ ファイルのパス]**  
このオプションは、テキスト ファイルのログのオプションが選択されている場合のみ使用できます。  ログ ファイルの場所のパスを指定します。 

### <a name="schedule-the-package"></a>パッケージのスケジュール設定
移動操作またはコピー操作をいつ開始するのかを指定します。  システム管理者でない場合は、Integration Services (SSIS) パッケージ実行サブシステムへのアクセス権がある SQL Server エージェント プロキシ アカウントを指定する必要があります。

> **重要!!** **デタッチ後にアタッチ** する方法では、Integration Services プロキシ アカウントを使用する必要があります。  

-    **[すぐに実行する]**  
     SSIS パッケージは、ウィザードの完了後に実行されます。
  
-    **[スケジュール]**  
     SSIS パッケージは、スケジュールに従って実行されます。 
  
     -    **[スケジュールの変更]**    
**[新しいジョブ スケジュール]** ダイアログ ボックスが表示されます。  必要に応じて構成します。  完了したら、 **[OK]** をクリックします。


-    **[Integration Services プロキシ アカウント]** ドロップダウン リストから利用可能なプロキシ アカウントを選択します。  転送をスケジュールするには、1 つ以上のプロキシ アカウントをユーザーが使用できる状態であり、 **SSIS パッケージ実行用サブシステム**に対する権限がこれらのアカウントに対して構成されている必要があります。

        SSIS パッケージ実行用のプロキシ アカウントを作成するには、 **オブジェクト エクスプローラー**で、 **[SQL Server エージェント]** を展開し、 **[プロキシ]** を展開してから、 **[SSIS パッケージ実行]** を右クリックして **[新しいプロキシ]** をクリックします。

### <a name="complete-the-wizard"></a>ウィザードの完了
選択したオプションの概要を表示します。  オプションを変更するには、 **[戻る]** をクリックします。  **[完了]** をクリックして、SSIS パッケージを作成します。 **データベース コピー ウィザード** の実行に関する状態情報が **[操作を実行しています]** ページに表示されます。

-    **操作**  
 実行されている各アクションが一覧表示されます。

-    **ステータス**  
 アクションが全体として成功したか、失敗したかを示します。

-    **メッセージ**  
各ステップで返されるメッセージが表示されます。

##  <a name="Examples"></a> 使用例
### <a name="common-steps"></a>**一般的な手順** 
**移動** または **コピー**、 **デタッチ後にアタッチ** または **SMO**を選択するかどうかにかかわらず、以下に示す 5 つの手順は同じになります。  簡潔にするため、最初の 5 つの手順をここに一度だけリストし、例はすべて **手順 6**から始めます。

1.  **オブジェクト エクスプローラー**で、SQL Server データベース エンジンのインスタンスに接続し、そのインスタンスを展開します。

2.  **[データベース]** を展開して目的のデータベースを右クリックします。 **[タスク]** をポイントし、 **[データベースのコピー]** をクリックします。

3.  **[データベース コピー ウィザードへようこそ]** のスプラッシュ ページが表示されたら、 **[次へ]** をクリックします。

4.  **[転送元サーバーの選択]** ページ: 移動またはコピーするデータベースがあるサーバーを指定します。  認証方法を選択します。  **[SQL Server 認証を使用する]** を選択した場合には、ログイン資格情報を入力する必要があります。  **[次へ]** をクリックして、転送元サーバーへの接続を確立します。  セッションの間、この接続は開いています。

5.  **[転送先サーバーの選択]** ページ: データベースの移動先またはコピー先のサーバーを指定します。  認証方法を選択します。  **[SQL Server 認証を使用する]** を選択した場合には、ログイン資格情報を入力する必要があります。  **[次へ]** をクリックして、転送元サーバーへの接続を確立します。  セッションの間、この接続は開いています。

     > **注:** 任意のデータベースからデータベース コピー ウィザードを起動することができます。  転送元または転送先のサーバーからデータベース コピー ウィザードを使用することができます。
  
### <a name="a--move-database-using-detach-and-attach-method-to-an-instance-on-a-different-physical-server--a-login-and-sql-server-agent-job-will-be-moved-as-well"></a>**A.デタッチ後にアタッチする方法を使用して、データベースを別の物理サーバー上のインスタンスに移動します。ログインと SQL Server エージェント ジョブも移動されます。**  
次の例は、 `Sales` データベース、 `contoso\Jennie` という名前の Windows ログイン、 `Jennie's Report` という名前の SQL Server エージェントを、 `Server1` 上の SQL Server の 2008 インスタンスから、 `Server2`上のSQL Server の 2016 インスタンスに移動します。  `Jennie's Report` は、 `Sales` データベースを使用します。  `Sales` は、移動先サーバー `Server2`にはまだ存在していません。  `Server1` は、データベースの移動後に、別のチームに再割り当てされます。
  
6.  上記の「 [制限事項と制約事項](#Restrictions)」で説明したように、移動先サーバーにまだ存在していないデータベースを参照する SQL Server エージェント ジョブを転送するときに、移動先サーバー上にシェル データベースを作成する必要があります。  `Sales` という名前のシェル データベースを移動先サーバー上に作成します。 

7.  **ウィザード**に戻り、 **[転送方法の選択]** ページで、既定値を確認して維持します。  **[次へ]** をクリックします。
  
8.  **[データベースの選択]** ページ: 目的のデータベース `Sales` の **[移動]** チェックボックスをオンにします。  **[次へ]** をクリックします。
  
9.  **[転送先データベースの構成]** ページ: **ウィザード** で、上記の **手順 6** で作成したように、 `Sales` が移動先のサーバーに存在していることが識別され、`_new` が **移動先データベース** 名に付加されています。  `_new` [転送先データベース] **テキスト ボックスから** を削除します。  必要に応じて、 **ファイル名**と **インストール先フォルダー**を変更します。  **[転送先サーバーに存在する同じ名前のすべてのデータベースを削除して、データベースの転送を続行し、既存のデータベース ファイルを上書きする]** を選択します。  **[次へ]** をクリックします。
  
10. **[サーバー オブジェクトの選択]** ページ: **[選択した関連オブジェクト]** パネルで、**オブジェクト名のログイン**の省略記号ボタンをクリックします。  **[コピー オプション]** の下で、 **[選択したログインのみコピーする:]** を選択します。  **[すべてのサーバー ログインを表示する]** チェックボックスをオンにします。  `contoso\Jennie` の **[ログイン]** チェックボックスをオンにします。  **[OK]** をクリックします。  **[使用可能な関連オブジェクト:]** パネルで、 **SQL Server エージェント ジョブ** を選択し、 **>** ボタンをクリックします。  **[選択した関連オブジェクト]** パネルで、 **SQL Server エージェント ジョブ**の省略記号ボタンをクリックします。  **[コピー オプション]** の下で、 **[選択したジョブのみコピーする]** を選択します。  `Jennie's Report`のチェック ボックスをオンにします。  **[OK]** をクリックします。  **[次へ]** をクリックします。  
  
11. **[転送元のデータベース ファイルの場所]** ページ: **転送元のサーバーでのファイル共有**の省略記号ボタンをクリックし、指定したフォルダーの場所に移動します。  たとえば、フォルダーの場所 `D:\MSSQL13.MSSQLSERVER\MSSQL\DATA` は、 **転送元のサーバーでのファイル共有** の `\\Server1\D$\MSSQL13.MSSQLSERVER\MSSQL\DATA` を使用します。  **[次へ]** をクリックします。
  
12. **[パッケージの構成]** ページ: **[パッケージ名]** テキスト ボックスに "`SalesFromServer1toServer2_Move`" を入力します。  **[転送ログを保存しますか?]** チェックボックスをオンにします。  **[ログ オプション]** ドロップダウン リストで **[テキスト ファイル]** を選択します。  必要に応じて、 **[エラー ログ ファイルのパス]** を変更します。  **[次へ]** をクリックします。  
  
     > **注:** **[エラー ログ ファイルのパス]** は、転送先サーバー上のパスです。
  
13. **[パッケージのスケジュール設定]** ページ: **[Integration Services プロキシ アカウント]** ドロップダウン リストから関連するプロキシを選択します。  **[次へ]** をクリックします。

14. **[ウィザードの完了]** ページ: 選択したオプションの概要を確認します。  オプションを変更するには、 **[戻る]** をクリックします。  **[完了]** をクリックしてタスクを実行します。  転送中は、 **ウィザード** の実行に関する状態情報が **[操作を実行しています]** ページに表示されます。

15. **[操作を実行しています]** ページ: 操作が成功したら、 **[閉じる]** をクリックします。  操作が失敗した場合は、エラー ログを確認し、場合によっては **[戻る]** でさらに確認します。  それ以外の場合は、 **[閉じる]** をクリックします。
  
16. **移動後の手順** 新しいホスト `Server2`で次の T-SQL ステートメントを実行することを検討します。
  
     ~~~ tsql 
     ALTER AUTHORIZATION ON DATABASE::Sales TO sa;

     ALTER DATABASE Sales 
     SET COMPATIBILITY_LEVEL = 130;

     USE Sales
     GO

     EXEC sp_updatestats;
     ~~~
 
17. **移動後の手順のクリーンアップ**  
`Server1` は別のチームに移動され、 **移動** 操作は繰り返されないため、次の手順の実行を検討してください。
     -    `SalesFromServer1toServer2_Move` で SSIS パッケージ `Server2`を削除する。
     -    `SalesFromServer1toServer2_Move` で SQL Server エージェント ジョブ `Server2`を削除する。
     -    `Jennie's Report` で SQL Server エージェント ジョブ `Server1`を削除する。
     -    `contoso\Jennie` で ログイン `Server1`を破棄する。


### <a name="b-----copy-database-using-detach-and-attach-method-to-the-same-instance-and-set-recurring-schedule"></a>**B.   デタッチの後にアタッチする方法を使用して、データベースを同じインスタンスにコピーし、定期的なスケジュールを設定します。**  
この例では、 `Sales` データベースがコピーされ、同じインスタンス上に `SalesCopy` として作成されます。  その後、 `SalesCopy`は週単位で再作成されます。

6.  **[転送方法の選択]** ページ: 既定値を確認して維持します。  **[次へ]** をクリックします。

7.  **[データベースの選択]** ページ: `Sales` データベースの **[コピー]** チェックボックスをオンにします。  **[次へ]** をクリックします。

8.  **[転送先データベースの構成]** ページ: **[転送先データベース]** の名前を `SalesCopy` に変更します。  必要に応じて、 **ファイル名**と **インストール先フォルダー**を変更します。  **[転送先サーバーに存在する同じ名前のすべてのデータベースを削除して、データベースの転送を続行し、既存のデータベース ファイルを上書きする]** を選択します。  **[次へ]** をクリックします。

9.  **[パッケージの構成]** ページ: **[パッケージ名]** テキスト ボックスに "`SalesCopy Weekly Refresh`" を入力します。  **[転送ログを保存しますか?]** チェックボックスをオンにします。  **[次へ]** をクリックします。

10. **[パッケージのスケジュール設定]** ページ: **[スケジュール]** オプション ボタンをクリックし、 **[スケジュールの変更]** ボタンをクリックします。 
 
    1. **[新しいジョブ スケジュール]** ページ: **[名前]** テキスト ボックスに "`Weekly on Sunday`" を入力します。 
          
    2. **[OK]** をクリックします。

11. **[Integration Services プロキシ アカウント]** ドロップダウン リストから関連するプロキシを選択します。  **[次へ]** をクリックします。

12. **[ウィザードの完了]** ページ: 選択したオプションの概要を確認します。  オプションを変更するには、 **[戻る]** をクリックします。  **[完了]** をクリックしてタスクを実行します。  パッケージの作成中は、 **ウィザード** の実行に関する状態情報が **[操作を実行しています]** ページに表示されます。

13. **[操作を実行しています]** ページ: 操作が成功したら、 **[閉じる]** をクリックします。  操作が失敗した場合は、エラー ログを確認し、場合によっては **[戻る]** でさらに確認します。  それ以外の場合は、 **[閉じる]** をクリックします。

14. 新しく作成された SQL Server エージェント ジョブ `SalesCopy weekly refresh`を手動で開始します。  ジョブ履歴を確認して、 `SalesCopy` がインスタンスに存在すること確認します。

  
##  <a name="FollowUp"></a> 補足情報: データベースをアップグレードした後  
 データベース コピー ウィザードを使用して、以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベースを [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]のバージョンにアップグレードした後は、データベースが直ちに使用可能となり、自動的にアップグレードされます。 データベースにフルテキスト インデックスがある場合、アップグレード プロセスでは、" **フルテキスト アップグレード オプション** " サーバー プロパティの設定に応じて、インポート、リセット、または再構築が行われます。 アップグレード オプションが **[インポート]** または **[再構築]** に設定されている場合、アップグレード中はフルテキスト インデックスを使用できなくなります。 インデックスを作成するデータ量によって、インポートには数時間、再構築には最大でその 10 倍の時間がかかることがあります。 なお、アップグレード オプションが **[インポート]** に設定されており、フルテキスト カタログが使用できない場合は、関連付けられたフルテキスト インデックスが再構築されます。 **フルテキスト アップグレード オプション** プロパティの設定の表示と変更については、「 [サーバー インスタンスでのフルテキスト検索の管理と監視](../../relational-databases/search/manage-and-monitor-full-text-search-for-a-server-instance.md)」を参照してください。  
  
 アップグレード前のユーザー データベースの互換性レベルが 100 以上の場合は、アップグレード後も互換性レベルは変わりません。 アップグレードされたデータベースの互換性レベルが 90 の場合、互換性レベルは 100 に設定されます。これは、[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] でサポートされている下限の互換性レベルです。 詳細については、「[ALTER DATABASE 互換性レベル &#40;Transact-SQL&#41;](../../t-sql/statements/alter-database-transact-sql-compatibility-level.md)」を参照してください。  
 
 ## <a name="Post"></a> コピーまたは移動後の考慮事項
 **コピー** または **移動**の後に、次の手順を実行するかどうかを検討します。
-    デタッチ後にアタッチの方法を使用する際に、データベースの所有権を変更する。
-    **移動**後に移動元のサーバーでサーバー オブジェクトを破棄する。
-    移動先サーバーで、ウィザードによって作成された SSIS パッケージを破棄する。
-    移動先サーバーで、ウィザードによって作成された SQL Server エージェント ジョブを破棄する。

  
## <a name="more-information"></a>その他の情報 
 [デタッチとアタッチを使用したデータベースのアップグレード &#40;Transact-SQL&#41;](../../relational-databases/databases/upgrade-a-database-using-detach-and-attach-transact-sql.md)   
 [SQL Server エージェント プロキシの作成](../../ssms/agent/create-a-sql-server-agent-proxy.md)  
  
  

